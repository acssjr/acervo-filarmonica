{"version":3,"sources":["../../../../../frontend-next/src/components/modals/SheetDetailModal.tsx","../../../../../frontend-next/src/hooks/useSheetDownload.ts","../../../../../frontend-next/src/components/modals/sheet/PartePicker.tsx","../../../../../frontend-next/src/components/modals/sheet/DownloadConfirm.tsx","../../../../../frontend-next/src/components/modals/sheet/InstrumentSelector.tsx","../../../../../frontend-next/src/components/modals/NotificationsPanel.tsx","../../../../../frontend-next/src/components/modals/ShareCartModal.tsx"],"sourcesContent":["\"use client\";\r\n\r\n// ===== SHEET DETAIL MODAL =====\r\n// Modal de detalhes da partitura com opcoes de download\r\n// Suporta URL compartilhavel: /acervo/:categoria/:id\r\n// Refatorado: extraido componentes e hook de download\r\n\r\nimport { useState, useEffect, useCallback, Suspense } from \"react\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\nimport dynamic from \"next/dynamic\";\r\nimport { motion, AnimatePresence } from \"motion/react\";\r\nimport { useAuth } from \"@contexts/AuthContext\";\r\nimport { useUI } from \"@contexts/UIContext\";\r\nimport { useData } from \"@contexts/DataContext\";\r\nimport { Icons } from \"@constants/icons\";\r\nimport { API } from \"@lib/api\";\r\nimport CategoryIcon from \"@components/common/CategoryIcon\";\r\nimport { useMediaQuery } from \"@hooks/useMediaQuery\";\r\nimport { useSheetDownload, findParteExata } from \"@hooks/useSheetDownload\";\r\nimport type { Parte } from \"@hooks/useSheetDownload\";\r\nimport { PartePicker, DownloadConfirm, InstrumentSelector } from \"./sheet\";\r\n\r\nconst PDFViewerModal = dynamic(() => import(\"./PDFViewerModal\"), {\r\n  ssr: false,\r\n});\r\n\r\nconst SheetDetailModal = () => {\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n  const { user } = useAuth();\r\n  const {\r\n    selectedSheet,\r\n    setSelectedSheet,\r\n    showToast,\r\n    addToShareCart,\r\n    removeFromShareCart,\r\n    shareCart,\r\n  } = useUI();\r\n  const { favorites, toggleFavorite, categoriesMap, instrumentNames } =\r\n    useData();\r\n\r\n  // Estado local\r\n  const isDesktop = useMediaQuery(\"(min-width: 1024px)\");\r\n  const [showInstrumentPicker, setShowInstrumentPicker] = useState(false);\r\n  const [partes, setPartes] = useState<Parte[]>([]);\r\n  const [loadingPartes, setLoadingPartes] = useState(false);\r\n\r\n  // Hook de download\r\n  const download = useSheetDownload({\r\n    showToast,\r\n    selectedSheet,\r\n    partes,\r\n  });\r\n\r\n  // Handler para adicionar parte ao carrinho de compartilhamento\r\n  const handleAddToCart = useCallback(\r\n    (instrument: string) => {\r\n      if (!selectedSheet) return;\r\n\r\n      const parte = findParteExata(instrument, partes);\r\n      if (parte) {\r\n        addToShareCart({\r\n          parteId: parte.id,\r\n          parteName: parte.instrumento,\r\n          partituraTitle: selectedSheet.title,\r\n          downloadUrl: \"\",\r\n        });\r\n        showToast(`${parte.instrumento} adicionado ao carrinho`);\r\n      } else {\r\n        showToast(\"Parte não encontrada\", \"error\");\r\n      }\r\n    },\r\n    [selectedSheet, partes, addToShareCart, showToast]\r\n  );\r\n\r\n  // Travar scroll do body quando modal estiver aberto\r\n  useEffect(() => {\r\n    if (selectedSheet) {\r\n      // Salvar posicao atual do scroll\r\n      const scrollY = window.scrollY;\r\n\r\n      // Aplicar classe que trava scroll (definida em base.css com !important)\r\n      document.documentElement.classList.add(\"modal-open\");\r\n      document.body.style.top = `-${scrollY}px`;\r\n\r\n      return () => {\r\n        // Restaurar scroll\r\n        document.documentElement.classList.remove(\"modal-open\");\r\n        document.body.style.top = \"\";\r\n        window.scrollTo(0, scrollY);\r\n      };\r\n    }\r\n  }, [selectedSheet]);\r\n\r\n  // Buscar partes quando abrir o modal\r\n  useEffect(() => {\r\n    if (!selectedSheet) return;\r\n\r\n    let cancelled = false;\r\n    setShowInstrumentPicker(false);\r\n    download.handleCancelDownload();\r\n\r\n    const fetchPartes = async () => {\r\n      setLoadingPartes(true);\r\n      try {\r\n        const data = await API.getPartesPartitura(selectedSheet.id);\r\n        if (!cancelled) {\r\n          setPartes(data || []);\r\n        }\r\n      } catch (e) {\r\n        if (!cancelled) {\r\n          console.error(\"Erro ao buscar partes:\", e);\r\n          setPartes([]);\r\n        }\r\n      }\r\n      if (!cancelled) {\r\n        setLoadingPartes(false);\r\n      }\r\n    };\r\n\r\n    fetchPartes();\r\n\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- download e estavel (useSheetDownload)\r\n  }, [selectedSheet]);\r\n\r\n  const handleClose = () => {\r\n    setSelectedSheet(null);\r\n    // Se estamos numa URL de partitura, volta para o acervo da categoria\r\n    if (\r\n      pathname.includes(\"/acervo/\") &&\r\n      pathname.split(\"/\").length > 3\r\n    ) {\r\n      const categoria = selectedSheet?.category || \"dobrado\";\r\n      router.push(`/acervo/${categoria}`);\r\n    }\r\n  };\r\n\r\n  // Dados derivados do selectedSheet (so acessados quando existe)\r\n  const category = selectedSheet\r\n    ? categoriesMap.get(selectedSheet.category)\r\n    : null;\r\n  const isFavorite = selectedSheet\r\n    ? favorites.includes(selectedSheet.id)\r\n    : false;\r\n  const userInstrument = user?.instrumento || \"Trompete Bb\";\r\n  const userInstrumentLower = userInstrument?.toLowerCase() || \"\";\r\n  const isMaestro =\r\n    userInstrumentLower === \"maestro\" || userInstrumentLower === \"regente\";\r\n  const hasGrade = partes.some(\r\n    (p) => p.instrumento?.toLowerCase() === \"grade\"\r\n  );\r\n  const availableInstruments =\r\n    partes.length > 0\r\n      ? [...new Set(partes.map((p) => p.instrumento))]\r\n      : instrumentNames;\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {selectedSheet && (\r\n        <>\r\n          {/* Overlay */}\r\n          <motion.div\r\n            key=\"sheet-modal-overlay\"\r\n            onClick={handleClose}\r\n            role=\"presentation\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            transition={{ duration: 0.2 }}\r\n            style={{\r\n              position: \"fixed\",\r\n              inset: 0,\r\n              background: \"rgba(0,0,0,0.6)\",\r\n              backdropFilter: \"blur(4px)\",\r\n              WebkitBackdropFilter: \"blur(4px)\",\r\n              zIndex: 2000,\r\n            }}\r\n          />\r\n\r\n          {/* Modal de Selecao de Partes */}\r\n          <PartePicker\r\n            isOpen={download.showPartePicker}\r\n            partes={download.partesDisponiveis}\r\n            instrumentName={download.confirmInstrument || \"\"}\r\n            downloading={download.downloading}\r\n            onSelectParte={download.downloadParteDireta}\r\n            onClose={download.closePartePicker}\r\n          />\r\n\r\n          {/* Modal de Confirmacao */}\r\n          <DownloadConfirm\r\n            isOpen={\r\n              !!download.confirmInstrument && !download.showPartePicker\r\n            }\r\n            instrumentName={download.confirmInstrument || \"\"}\r\n            downloading={download.downloading}\r\n            onConfirm={download.handleConfirmDownload}\r\n            onCancel={download.handleCancelDownload}\r\n          />\r\n\r\n          {/* Visualizador de PDF embutido */}\r\n          <Suspense\r\n            fallback={\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  alignItems: \"center\",\r\n                  justifyContent: \"center\",\r\n                  padding: \"32px\",\r\n                }}\r\n              >\r\n                Carregando visualizador...\r\n              </div>\r\n            }\r\n          >\r\n            <PDFViewerModal\r\n              isOpen={download.pdfViewer.isOpen}\r\n              pdfUrl={download.pdfViewer.url}\r\n              title={`${download.pdfViewer.title} - ${download.pdfViewer.instrument}`}\r\n              onClose={download.closePdfViewer}\r\n              onDownload={() => {\r\n                // Abre em nova aba como fallback\r\n                if (download.pdfViewer.url) {\r\n                  window.open(download.pdfViewer.url, \"_blank\");\r\n                }\r\n              }}\r\n            />\r\n          </Suspense>\r\n\r\n          {/* Modal Principal */}\r\n          <motion.div\r\n            key=\"sheet-modal-content\"\r\n            role=\"dialog\"\r\n            aria-modal=\"true\"\r\n            aria-labelledby=\"sheet-detail-title\"\r\n            initial={\r\n              isDesktop\r\n                ? { opacity: 0, scale: 0.95 }\r\n                : { opacity: 1, y: \"100%\" }\r\n            }\r\n            animate={\r\n              isDesktop\r\n                ? { opacity: 1, scale: 1 }\r\n                : { opacity: 1, y: 0 }\r\n            }\r\n            exit={\r\n              isDesktop\r\n                ? { opacity: 0, scale: 0.95 }\r\n                : { opacity: 1, y: \"100%\" }\r\n            }\r\n            transition={{\r\n              type: \"spring\" as const,\r\n              stiffness: 350,\r\n              damping: 30,\r\n            }}\r\n            style={{\r\n              position: \"fixed\",\r\n              ...(isDesktop\r\n                ? {\r\n                    top: \"50%\",\r\n                    left: \"50%\",\r\n                    x: \"-50%\",\r\n                    y: \"-50%\",\r\n                    width: \"420px\",\r\n                    maxWidth: \"90vw\",\r\n                    borderRadius: \"20px\",\r\n                  }\r\n                : {\r\n                    bottom: 0,\r\n                    left: 0,\r\n                    right: 0,\r\n                    borderRadius: \"24px 24px 0 0\",\r\n                  }),\r\n              background: \"var(--bg-card)\",\r\n              zIndex: 2001,\r\n              maxHeight: isDesktop ? \"85vh\" : \"90vh\",\r\n              overflow: \"hidden\",\r\n              boxShadow: \"0 25px 50px -12px rgba(0, 0, 0, 0.25)\",\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n            }}\r\n          >\r\n            {/* Handle - apenas mobile */}\r\n            {!isDesktop && (\r\n              <div\r\n                style={{\r\n                  width: \"40px\",\r\n                  height: \"4px\",\r\n                  background: \"var(--border)\",\r\n                  borderRadius: \"2px\",\r\n                  margin: \"12px auto\",\r\n                  flexShrink: 0,\r\n                }}\r\n              />\r\n            )}\r\n\r\n            {/* Header com imagem */}\r\n            <div\r\n              style={{\r\n                background:\r\n                  \"linear-gradient(145deg, rgba(212, 175, 55, 0.15) 0%, rgba(212, 175, 55, 0.05) 100%)\",\r\n                padding: isDesktop ? \"20px\" : \"16px 20px\",\r\n                position: \"relative\",\r\n                overflow: \"hidden\",\r\n                flexShrink: 0,\r\n              }}\r\n            >\r\n              <div\r\n                style={{\r\n                  position: \"absolute\",\r\n                  top: \"-20px\",\r\n                  right: \"-20px\",\r\n                  width: \"100px\",\r\n                  height: \"100px\",\r\n                  background: \"rgba(212, 175, 55, 0.1)\",\r\n                  borderRadius: \"50%\",\r\n                }}\r\n              />\r\n\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  gap: \"14px\",\r\n                  alignItems: \"flex-start\",\r\n                  position: \"relative\",\r\n                  zIndex: 1,\r\n                }}\r\n              >\r\n                <div\r\n                  style={{\r\n                    width: \"56px\",\r\n                    height: \"56px\",\r\n                    borderRadius: \"14px\",\r\n                    background:\r\n                      \"linear-gradient(145deg, #3a3a4a 0%, #2a2a38 100%)\",\r\n                    border:\r\n                      \"1px solid rgba(212, 175, 55, 0.2)\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    flexShrink: 0,\r\n                  }}\r\n                >\r\n                  <CategoryIcon\r\n                    categoryId={category?.id || \"\"}\r\n                    size={26}\r\n                    color=\"var(--accent)\"\r\n                  />\r\n                </div>\r\n\r\n                <div style={{ flex: 1, minWidth: 0 }}>\r\n                  <h2\r\n                    id=\"sheet-detail-title\"\r\n                    style={{\r\n                      fontFamily: \"var(--font-sans)\",\r\n                      fontSize: \"17px\",\r\n                      fontWeight: \"700\",\r\n                      color: \"var(--text-primary)\",\r\n                      marginBottom: \"3px\",\r\n                      lineHeight: \"1.3\",\r\n                    }}\r\n                  >\r\n                    {selectedSheet.title}\r\n                  </h2>\r\n                  <p\r\n                    style={{\r\n                      fontFamily: \"var(--font-sans)\",\r\n                      fontSize: \"13px\",\r\n                      color: \"var(--text-muted)\",\r\n                      marginBottom: \"6px\",\r\n                    }}\r\n                  >\r\n                    {selectedSheet.composer}\r\n                  </p>\r\n                  <span\r\n                    style={{\r\n                      display: \"inline-block\",\r\n                      padding: \"3px 8px\",\r\n                      background: \"rgba(212, 175, 55, 0.15)\",\r\n                      color: \"var(--accent)\",\r\n                      borderRadius: \"6px\",\r\n                      fontSize: \"10px\",\r\n                      fontWeight: \"600\",\r\n                      fontFamily: \"var(--font-sans)\",\r\n                    }}\r\n                  >\r\n                    {category?.name}\r\n                  </span>\r\n                </div>\r\n\r\n                <button\r\n                  onClick={handleClose}\r\n                  aria-label=\"Fechar modal\"\r\n                  style={{\r\n                    width: \"32px\",\r\n                    height: \"32px\",\r\n                    borderRadius: \"50%\",\r\n                    background: \"var(--bg-secondary)\",\r\n                    border: \"none\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    cursor: \"pointer\",\r\n                    color: \"var(--text-muted)\",\r\n                    flexShrink: 0,\r\n                  }}\r\n                >\r\n                  <div style={{ width: \"16px\", height: \"16px\" }}>\r\n                    <Icons.Close />\r\n                  </div>\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Conteudo scrollavel */}\r\n            <div\r\n              style={{\r\n                padding: isDesktop\r\n                  ? \"16px 20px 20px\"\r\n                  : \"16px 20px 28px\",\r\n                overflowY: \"auto\",\r\n                flex: 1,\r\n              }}\r\n            >\r\n              {/* Info compacta */}\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  gap: \"8px\",\r\n                  marginBottom: \"16px\",\r\n                  flexWrap: \"wrap\",\r\n                }}\r\n              >\r\n                <div\r\n                  style={{\r\n                    background: \"var(--bg-secondary)\",\r\n                    padding: \"8px 12px\",\r\n                    borderRadius: \"8px\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    gap: \"6px\",\r\n                  }}\r\n                >\r\n                  <div\r\n                    style={{\r\n                      width: \"12px\",\r\n                      height: \"12px\",\r\n                      color: \"var(--text-muted)\",\r\n                    }}\r\n                  >\r\n                    <Icons.Download />\r\n                  </div>\r\n                  <span\r\n                    style={{\r\n                      fontSize: \"12px\",\r\n                      fontWeight: \"600\",\r\n                      color: \"var(--text-primary)\",\r\n                      fontFamily: \"var(--font-sans)\",\r\n                    }}\r\n                  >\r\n                    {selectedSheet.downloads || 0}\r\n                  </span>\r\n                </div>\r\n                <div\r\n                  style={{\r\n                    background: \"var(--bg-secondary)\",\r\n                    padding: \"8px 12px\",\r\n                    borderRadius: \"8px\",\r\n                  }}\r\n                >\r\n                  <span\r\n                    style={{\r\n                      fontSize: \"12px\",\r\n                      fontWeight: \"600\",\r\n                      color: \"var(--text-primary)\",\r\n                      fontFamily: \"var(--font-sans)\",\r\n                    }}\r\n                  >\r\n                    {selectedSheet.year}\r\n                  </span>\r\n                </div>\r\n                {selectedSheet.featured && (\r\n                  <div\r\n                    style={{\r\n                      background: \"rgba(212, 175, 55, 0.15)\",\r\n                      padding: \"8px 12px\",\r\n                      borderRadius: \"8px\",\r\n                    }}\r\n                  >\r\n                    <span\r\n                      style={{\r\n                        fontSize: \"12px\",\r\n                        fontWeight: \"600\",\r\n                        color: \"var(--accent)\",\r\n                        fontFamily: \"var(--font-sans)\",\r\n                        display: \"flex\",\r\n                        alignItems: \"center\",\r\n                        gap: \"4px\",\r\n                      }}\r\n                    >\r\n                      <svg\r\n                        width=\"12\"\r\n                        height=\"12\"\r\n                        viewBox=\"0 0 24 24\"\r\n                        fill=\"var(--accent)\"\r\n                        stroke=\"none\"\r\n                        aria-hidden=\"true\"\r\n                      >\r\n                        <polygon points=\"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\" />\r\n                      </svg>\r\n                      Destaque\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Opcoes de Download */}\r\n              <div style={{ marginBottom: \"14px\" }}>\r\n                <p\r\n                  style={{\r\n                    fontSize: \"10px\",\r\n                    color: \"var(--text-muted)\",\r\n                    marginBottom: \"8px\",\r\n                    fontFamily: \"var(--font-sans)\",\r\n                    textTransform: \"uppercase\",\r\n                    letterSpacing: \"0.5px\",\r\n                    fontWeight: \"600\",\r\n                  }}\r\n                >\r\n                  Baixar Partitura\r\n                </p>\r\n\r\n                {/* Botao Download - Meu Instrumento ou Grade (Maestro) */}\r\n                {isMaestro && !hasGrade && !loadingPartes ? (\r\n                  /* Botao desabilitado quando nao ha grade */\r\n                  <button\r\n                    data-walkthrough=\"quick-download\"\r\n                    disabled\r\n                    aria-label=\"Grade não disponível\"\r\n                    style={{\r\n                      width: \"100%\",\r\n                      padding: \"12px 14px\",\r\n                      borderRadius: \"10px\",\r\n                      background: \"var(--bg-secondary)\",\r\n                      border: \"1px solid var(--border)\",\r\n                      color: \"var(--text-muted)\",\r\n                      fontFamily: \"var(--font-sans)\",\r\n                      fontSize: \"13px\",\r\n                      fontWeight: \"600\",\r\n                      cursor: \"not-allowed\",\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      justifyContent: \"space-between\",\r\n                      marginBottom: \"8px\",\r\n                      opacity: 0.6,\r\n                    }}\r\n                  >\r\n                    <div\r\n                      style={{\r\n                        display: \"flex\",\r\n                        alignItems: \"center\",\r\n                        gap: \"8px\",\r\n                      }}\r\n                    >\r\n                      <div\r\n                        style={{\r\n                          width: \"16px\",\r\n                          height: \"16px\",\r\n                        }}\r\n                      >\r\n                        <Icons.Download />\r\n                      </div>\r\n                      <span>Grade nao disponivel</span>\r\n                    </div>\r\n                    <span\r\n                      style={{\r\n                        background: \"var(--bg-card)\",\r\n                        padding: \"3px 8px\",\r\n                        borderRadius: \"5px\",\r\n                        fontSize: \"10px\",\r\n                        fontWeight: \"700\",\r\n                      }}\r\n                    >\r\n                      Indisponivel\r\n                    </span>\r\n                  </button>\r\n                ) : (\r\n                  <button\r\n                    data-walkthrough=\"quick-download\"\r\n                    onClick={() =>\r\n                      download.handleSelectInstrument(\r\n                        isMaestro ? \"Grade\" : userInstrument\r\n                      )\r\n                    }\r\n                    aria-label={\r\n                      isMaestro\r\n                        ? \"Baixar grade\"\r\n                        : `Baixar partitura para ${userInstrument}`\r\n                    }\r\n                    disabled={loadingPartes}\r\n                    style={{\r\n                      width: \"100%\",\r\n                      padding: \"12px 14px\",\r\n                      borderRadius: \"10px\",\r\n                      background: loadingPartes\r\n                        ? \"var(--bg-secondary)\"\r\n                        : \"linear-gradient(145deg, #722F37 0%, #5C1A1B 100%)\",\r\n                      border: \"none\",\r\n                      color: loadingPartes\r\n                        ? \"var(--text-muted)\"\r\n                        : \"#F4E4BC\",\r\n                      fontFamily: \"var(--font-sans)\",\r\n                      fontSize: \"13px\",\r\n                      fontWeight: \"600\",\r\n                      cursor: loadingPartes ? \"wait\" : \"pointer\",\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      justifyContent: \"space-between\",\r\n                      marginBottom: \"8px\",\r\n                      boxShadow: loadingPartes\r\n                        ? \"none\"\r\n                        : \"0 4px 12px rgba(114, 47, 55, 0.3)\",\r\n                    }}\r\n                  >\r\n                    <div\r\n                      style={{\r\n                        display: \"flex\",\r\n                        alignItems: \"center\",\r\n                        gap: \"8px\",\r\n                      }}\r\n                    >\r\n                      <div\r\n                        style={{\r\n                          width: \"16px\",\r\n                          height: \"16px\",\r\n                        }}\r\n                      >\r\n                        <Icons.Download />\r\n                      </div>\r\n                      <span>\r\n                        {loadingPartes\r\n                          ? \"Carregando...\"\r\n                          : isMaestro\r\n                            ? \"Baixar Grade\"\r\n                            : \"Meu Instrumento\"}\r\n                      </span>\r\n                    </div>\r\n                    <span\r\n                      style={{\r\n                        background: \"rgba(244, 228, 188, 0.2)\",\r\n                        padding: \"3px 8px\",\r\n                        borderRadius: \"5px\",\r\n                        fontSize: \"10px\",\r\n                        fontWeight: \"700\",\r\n                      }}\r\n                    >\r\n                      {isMaestro ? \"Grade\" : userInstrument}\r\n                    </span>\r\n                  </button>\r\n                )}\r\n\r\n                {/* Seletor de Outros Instrumentos */}\r\n                <div data-walkthrough=\"instrument-selector\">\r\n                  <InstrumentSelector\r\n                    isOpen={showInstrumentPicker}\r\n                    instruments={availableInstruments}\r\n                    userInstrument={userInstrument}\r\n                    isMaestro={isMaestro}\r\n                    downloading={download.downloading}\r\n                    canShare={download.canShareFiles()}\r\n                    shareCart={shareCart\r\n                      .filter(\r\n                        (item) =>\r\n                          item.parteId !== undefined\r\n                      )\r\n                      .map((item) => ({\r\n                        instrument: item.parteName,\r\n                        parteId: item.parteId,\r\n                      }))}\r\n                    onToggle={() =>\r\n                      setShowInstrumentPicker(\r\n                        !showInstrumentPicker\r\n                      )\r\n                    }\r\n                    onSelectInstrument={\r\n                      download.handleSelectParteEspecifica\r\n                    }\r\n                    onPrintInstrument={\r\n                      download.handlePrintInstrument\r\n                    }\r\n                    onViewInstrument={\r\n                      download.handleViewInstrument\r\n                    }\r\n                    onShareInstrument={\r\n                      download.handleShareInstrument\r\n                    }\r\n                    onAddToCart={handleAddToCart}\r\n                    onRemoveFromCart={removeFromShareCart}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Botoes Imprimir, Compartilhar e Favoritar */}\r\n              <div\r\n                data-walkthrough=\"sheet-options\"\r\n                style={{ display: \"flex\", gap: \"8px\" }}\r\n              >\r\n                <button\r\n                  onClick={() =>\r\n                    download.handlePrintInstrument(\r\n                      isMaestro ? \"Grade\" : userInstrument\r\n                    )\r\n                  }\r\n                  disabled={\r\n                    download.downloading ||\r\n                    loadingPartes ||\r\n                    (isMaestro && !hasGrade)\r\n                  }\r\n                  aria-label=\"Imprimir partitura\"\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: \"10px\",\r\n                    borderRadius: \"10px\",\r\n                    background:\r\n                      isMaestro && !hasGrade\r\n                        ? \"var(--bg-secondary)\"\r\n                        : \"rgba(52, 152, 219, 0.1)\",\r\n                    border:\r\n                      isMaestro && !hasGrade\r\n                        ? \"1.5px solid var(--border)\"\r\n                        : \"1.5px solid rgba(52, 152, 219, 0.3)\",\r\n                    color:\r\n                      isMaestro && !hasGrade\r\n                        ? \"var(--text-muted)\"\r\n                        : \"#3498db\",\r\n                    fontFamily: \"var(--font-sans)\",\r\n                    fontSize: \"12px\",\r\n                    fontWeight: \"600\",\r\n                    cursor:\r\n                      (isMaestro && !hasGrade) ||\r\n                      download.downloading ||\r\n                      loadingPartes\r\n                        ? \"not-allowed\"\r\n                        : \"pointer\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    gap: \"6px\",\r\n                    opacity:\r\n                      isMaestro && !hasGrade ? 0.5 : 1,\r\n                  }}\r\n                >\r\n                  <div\r\n                    style={{ width: \"14px\", height: \"14px\" }}\r\n                  >\r\n                    <Icons.Printer />\r\n                  </div>\r\n                  Imprimir\r\n                </button>\r\n\r\n                {/* Botao Compartilhar - apenas se suportado */}\r\n                {download.canShareFiles() && (\r\n                  <button\r\n                    onClick={() =>\r\n                      download.handleShareInstrument(\r\n                        isMaestro ? \"Grade\" : userInstrument\r\n                      )\r\n                    }\r\n                    disabled={\r\n                      download.downloading ||\r\n                      loadingPartes ||\r\n                      (isMaestro && !hasGrade)\r\n                    }\r\n                    aria-label=\"Compartilhar partitura\"\r\n                    style={{\r\n                      flex: 1,\r\n                      padding: \"10px\",\r\n                      borderRadius: \"10px\",\r\n                      background:\r\n                        isMaestro && !hasGrade\r\n                          ? \"var(--bg-secondary)\"\r\n                          : \"rgba(37, 211, 102, 0.1)\",\r\n                      border:\r\n                        isMaestro && !hasGrade\r\n                          ? \"1.5px solid var(--border)\"\r\n                          : \"1.5px solid rgba(37, 211, 102, 0.3)\",\r\n                      color:\r\n                        isMaestro && !hasGrade\r\n                          ? \"var(--text-muted)\"\r\n                          : \"#25D366\",\r\n                      fontFamily: \"var(--font-sans)\",\r\n                      fontSize: \"12px\",\r\n                      fontWeight: \"600\",\r\n                      cursor:\r\n                        (isMaestro && !hasGrade) ||\r\n                        download.downloading ||\r\n                        loadingPartes\r\n                          ? \"not-allowed\"\r\n                          : \"pointer\",\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      justifyContent: \"center\",\r\n                      gap: \"6px\",\r\n                      opacity:\r\n                        isMaestro && !hasGrade ? 0.5 : 1,\r\n                    }}\r\n                  >\r\n                    <div\r\n                      style={{\r\n                        width: \"14px\",\r\n                        height: \"14px\",\r\n                      }}\r\n                    >\r\n                      <Icons.Share />\r\n                    </div>\r\n                    Enviar\r\n                  </button>\r\n                )}\r\n\r\n                <button\r\n                  onClick={() =>\r\n                    toggleFavorite(selectedSheet.id)\r\n                  }\r\n                  aria-pressed={isFavorite}\r\n                  aria-label={\r\n                    isFavorite\r\n                      ? \"Remover dos favoritos\"\r\n                      : \"Adicionar aos favoritos\"\r\n                  }\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: \"10px\",\r\n                    borderRadius: \"10px\",\r\n                    background: isFavorite\r\n                      ? \"rgba(232,90,79,0.1)\"\r\n                      : \"transparent\",\r\n                    border: isFavorite\r\n                      ? \"1.5px solid var(--primary)\"\r\n                      : \"1.5px solid var(--border)\",\r\n                    color: isFavorite\r\n                      ? \"var(--primary)\"\r\n                      : \"var(--text-muted)\",\r\n                    fontFamily: \"var(--font-sans)\",\r\n                    fontSize: \"12px\",\r\n                    fontWeight: \"600\",\r\n                    cursor: \"pointer\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    gap: \"6px\",\r\n                  }}\r\n                >\r\n                  <div\r\n                    style={{ width: \"14px\", height: \"14px\" }}\r\n                  >\r\n                    <Icons.Heart filled={isFavorite} />\r\n                  </div>\r\n                  {isFavorite ? \"Favorito\" : \"Favoritar\"}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </motion.div>\r\n        </>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\nexport default SheetDetailModal;\r\n","\"use client\";\r\n\r\n// ===== USE SHEET DOWNLOAD HOOK =====\r\n// Hook para gerenciar download de partituras\r\n// Extraido de SheetDetailModal para melhor testabilidade\r\n\r\nimport { useState, useCallback } from \"react\";\r\nimport { API_BASE_URL } from \"@constants/api\";\r\nimport Storage from \"@lib/storage\";\r\n\r\n// ===== Types =====\r\n\r\nexport interface Parte {\r\n  id: string | number;\r\n  instrumento: string;\r\n  [key: string]: unknown;\r\n}\r\n\r\nexport interface Sheet {\r\n  id: string;\r\n  title: string;\r\n  composer?: string;\r\n  category?: string;\r\n  downloads?: number;\r\n  year?: string | number;\r\n  featured?: boolean;\r\n}\r\n\r\nexport interface PdfViewerState {\r\n  isOpen: boolean;\r\n  url: string | null;\r\n  title: string;\r\n  instrument: string;\r\n}\r\n\r\nexport interface UseSheetDownloadOptions {\r\n  showToast: (message: string, type?: string) => void;\r\n  selectedSheet: Sheet | null;\r\n  partes?: Parte[];\r\n}\r\n\r\n// ===== Helpers =====\r\n\r\n/**\r\n * Salva um blob como arquivo para download\r\n * Compativel com navegadores modernos e IE/Edge legado\r\n */\r\nconst saveBlob = (blob: Blob, filename: string): void => {\r\n  // Metodo 1: msSaveBlob para IE/Edge legado\r\n  const nav = window.navigator as Navigator & {\r\n    msSaveBlob?: (blob: Blob, defaultName?: string) => boolean;\r\n  };\r\n  if (nav.msSaveBlob) {\r\n    nav.msSaveBlob(blob, filename);\r\n    return;\r\n  }\r\n\r\n  // Metodo 2: Criar link com blob URL\r\n  const url = window.URL.createObjectURL(blob);\r\n  const link = document.createElement(\"a\");\r\n  link.href = url;\r\n  link.download = filename;\r\n  link.style.display = \"none\";\r\n\r\n  // Importante: adicionar ao DOM antes de clicar\r\n  document.body.appendChild(link);\r\n\r\n  // Usar setTimeout para garantir que o DOM foi atualizado\r\n  setTimeout(() => {\r\n    link.click();\r\n    // Limpar apos um tempo maior\r\n    setTimeout(() => {\r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(url);\r\n    }, 250);\r\n  }, 0);\r\n};\r\n\r\n/**\r\n * Normaliza nome de instrumento para comparacao\r\n * Converte variantes como \"Saxofone Alto\" -> \"sax alto\"\r\n */\r\nconst normalizeInstrumento = (nome: string): string => {\r\n  return nome\r\n    .toLowerCase()\r\n    .replace(/\\./g, \"\") // Remove pontos: \"Sax.\" -> \"Sax\"\r\n    .replace(/saxofone/g, \"sax\") // Normaliza Saxofone -> Sax\r\n    .replace(/clarineta/g, \"clarinete\") // Variante\r\n    .replace(/\\s+/g, \" \") // Colapsa espacos\r\n    .trim();\r\n};\r\n\r\n/**\r\n * Extrai tonalidade de um nome de instrumento normalizado\r\n * Ex: \"trompa f\" -> \"f\", \"trompete bb 1\" -> \"bb\", \"clarinete\" -> null\r\n */\r\nconst extractTonalidade = (nome: string): string | null => {\r\n  const match = nome.match(/\\s+(bb|eb|f|c)\\b/i);\r\n  return match ? match[1].toLowerCase() : null;\r\n};\r\n\r\n/**\r\n * Encontra partes correspondentes ao instrumento\r\n * Considera variacoes como \"Trompete Bb 1\", \"Trompete Bb 2\"\r\n * E normaliza nomes: \"Saxofone Soprano\" -> \"Sax Soprano\"\r\n * IMPORTANTE: Nao mistura tonalidades (Trompa F nao baixa Trompa Eb)\r\n */\r\nexport const findPartesCorrespondentes = (\r\n  instrumento: string,\r\n  partes: Parte[]\r\n): Parte[] => {\r\n  if (!instrumento || partes.length === 0) return [];\r\n\r\n  const instrNorm = normalizeInstrumento(instrumento);\r\n  const instrTonalidade = extractTonalidade(instrNorm);\r\n  const instrBase = instrNorm.replace(/\\s*(bb|eb|f|c)?\\s*\\d*$/i, \"\").trim();\r\n\r\n  return partes.filter((p) => {\r\n    const parteNorm = normalizeInstrumento(p.instrumento);\r\n    const parteTonalidade = extractTonalidade(parteNorm);\r\n    const parteBase = parteNorm.replace(/\\s*(bb|eb|f|c)?\\s*\\d*$/i, \"\").trim();\r\n\r\n    // Se ambos tem tonalidade e sao diferentes, nao combina\r\n    // Ex: Trompa F nao baixa Trompa Eb\r\n    if (\r\n      instrTonalidade &&\r\n      parteTonalidade &&\r\n      instrTonalidade !== parteTonalidade\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    return (\r\n      parteNorm === instrNorm ||\r\n      parteNorm.startsWith(instrNorm) ||\r\n      parteBase === instrBase ||\r\n      instrNorm.startsWith(parteBase)\r\n    );\r\n  });\r\n};\r\n\r\n/**\r\n * Encontra parte exata pelo nome do instrumento\r\n */\r\nexport const findParteExata = (\r\n  instrumento: string,\r\n  partes: Parte[]\r\n): Parte | undefined => {\r\n  return partes.find(\r\n    (p) => p.instrumento.toLowerCase() === instrumento.toLowerCase()\r\n  );\r\n};\r\n\r\n/**\r\n * Hook para gerenciar downloads de partituras\r\n */\r\nexport const useSheetDownload = ({\r\n  showToast,\r\n  selectedSheet,\r\n  partes = [],\r\n}: UseSheetDownloadOptions) => {\r\n  const [downloading, setDownloading] = useState(false);\r\n  const [confirmInstrument, setConfirmInstrument] = useState<string | null>(\r\n    null\r\n  );\r\n  const [selectedParte, setSelectedParte] = useState<Parte | null>(null);\r\n  const [showPartePicker, setShowPartePicker] = useState(false);\r\n  const [partesDisponiveis, setPartesDisponiveis] = useState<Parte[]>([]);\r\n\r\n  // Estado para o visualizador de PDF embutido (mobile)\r\n  const [pdfViewer, setPdfViewer] = useState<PdfViewerState>({\r\n    isOpen: false,\r\n    url: null,\r\n    title: \"\",\r\n    instrument: \"\",\r\n  });\r\n\r\n  /**\r\n   * Download direto de uma parte especifica\r\n   */\r\n  const downloadParteDireta = useCallback(\r\n    async (parte: Parte) => {\r\n      if (downloading || !selectedSheet) return;\r\n      setDownloading(true);\r\n\r\n      showToast(\r\n        `Preparando \"${selectedSheet.title}\" - ${parte.instrumento}...`\r\n      );\r\n\r\n      try {\r\n        const response = await fetch(\r\n          `${API_BASE_URL}/api/download/parte/${parte.id}`,\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${Storage.get<string | null>(\"authToken\", null)}`,\r\n            },\r\n          }\r\n        );\r\n\r\n        if (response.ok) {\r\n          // Extrair nome do arquivo do header Content-Disposition se disponivel\r\n          let filename = `${selectedSheet.title} - ${parte.instrumento}.pdf`;\r\n          const contentDisposition =\r\n            response.headers.get(\"Content-Disposition\");\r\n          if (contentDisposition) {\r\n            const match = contentDisposition.match(/filename=\"(.+)\"/);\r\n            if (match) filename = match[1];\r\n          }\r\n\r\n          const blob = await response.blob();\r\n          // Criar blob com tipo explicito para PDF\r\n          const pdfBlob = new Blob([blob], { type: \"application/pdf\" });\r\n\r\n          // Usar funcao de save dedicada\r\n          saveBlob(pdfBlob, filename);\r\n\r\n          showToast(\"Download iniciado!\");\r\n        } else {\r\n          const error = await response.json().catch(() => ({}));\r\n          showToast(\r\n            (error as { error?: string }).error || \"Erro ao baixar arquivo\",\r\n            \"error\"\r\n          );\r\n        }\r\n      } catch (e) {\r\n        console.error(\"Erro no download:\", e);\r\n        showToast(\"Erro ao baixar arquivo\", \"error\");\r\n      }\r\n\r\n      setDownloading(false);\r\n      setShowPartePicker(false);\r\n      setConfirmInstrument(null);\r\n    },\r\n    [downloading, selectedSheet, showToast]\r\n  );\r\n\r\n  /**\r\n   * Download do arquivo completo da partitura (fallback)\r\n   */\r\n  const downloadCompleto = useCallback(async () => {\r\n    if (downloading || !selectedSheet) return;\r\n    setDownloading(true);\r\n\r\n    showToast(`Preparando \"${selectedSheet.title}\"...`);\r\n\r\n    try {\r\n      const response = await fetch(\r\n        `${API_BASE_URL}/api/download/${selectedSheet.id}`,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${Storage.get<string | null>(\"authToken\", null)}`,\r\n          },\r\n        }\r\n      );\r\n\r\n      if (response.ok) {\r\n        const blob = await response.blob();\r\n        const pdfBlob = new Blob([blob], { type: \"application/pdf\" });\r\n        saveBlob(pdfBlob, `${selectedSheet.title}.pdf`);\r\n        showToast(\"Iniciando download...\");\r\n      } else {\r\n        showToast(\"Erro ao baixar arquivo\", \"error\");\r\n      }\r\n    } catch (e) {\r\n      console.error(\"Erro no download:\", e);\r\n      showToast(\"Erro ao baixar arquivo\", \"error\");\r\n    }\r\n\r\n    setDownloading(false);\r\n  }, [downloading, selectedSheet, showToast]);\r\n\r\n  /**\r\n   * Seleciona um instrumento e decide o fluxo de download\r\n   */\r\n  const handleSelectInstrument = useCallback(\r\n    (instrument: string) => {\r\n      const correspondentes = findPartesCorrespondentes(instrument, partes);\r\n\r\n      if (correspondentes.length === 0) {\r\n        // Nenhuma parte encontrada - vai para confirmacao\r\n        setConfirmInstrument(instrument);\r\n      } else if (correspondentes.length === 1) {\r\n        // Apenas uma parte - download direto\r\n        downloadParteDireta(correspondentes[0]);\r\n      } else {\r\n        // Multiplas partes - mostrar picker\r\n        setPartesDisponiveis(correspondentes);\r\n        setShowPartePicker(true);\r\n        setConfirmInstrument(instrument);\r\n      }\r\n    },\r\n    [partes, downloadParteDireta]\r\n  );\r\n\r\n  /**\r\n   * Seleciona uma parte especifica pelo nome exato\r\n   */\r\n  const handleSelectParteEspecifica = useCallback(\r\n    (instrumento: string) => {\r\n      const parte = findParteExata(instrumento, partes);\r\n      if (parte) {\r\n        setConfirmInstrument(instrumento);\r\n        setSelectedParte(parte);\r\n      } else {\r\n        showToast(\"Parte não encontrada\", \"error\");\r\n      }\r\n    },\r\n    [partes, showToast]\r\n  );\r\n\r\n  /**\r\n   * Confirma e executa o download\r\n   */\r\n  const handleConfirmDownload = useCallback(async () => {\r\n    if (selectedParte) {\r\n      await downloadParteDireta(selectedParte);\r\n      setConfirmInstrument(null);\r\n      setSelectedParte(null);\r\n      return;\r\n    }\r\n\r\n    const correspondentes = findPartesCorrespondentes(\r\n      confirmInstrument!,\r\n      partes\r\n    );\r\n\r\n    if (correspondentes.length > 0) {\r\n      await downloadParteDireta(correspondentes[0]);\r\n    } else {\r\n      await downloadCompleto();\r\n    }\r\n\r\n    setConfirmInstrument(null);\r\n  }, [\r\n    selectedParte,\r\n    confirmInstrument,\r\n    partes,\r\n    downloadParteDireta,\r\n    downloadCompleto,\r\n  ]);\r\n\r\n  /**\r\n   * Cancela o fluxo de download\r\n   */\r\n  const handleCancelDownload = useCallback(() => {\r\n    setConfirmInstrument(null);\r\n    setSelectedParte(null);\r\n    setShowPartePicker(false);\r\n    setPartesDisponiveis([]);\r\n  }, []);\r\n\r\n  /**\r\n   * Fecha o picker de partes\r\n   */\r\n  const closePartePicker = useCallback(() => {\r\n    setShowPartePicker(false);\r\n    setConfirmInstrument(null);\r\n  }, []);\r\n\r\n  /**\r\n   * Imprime uma parte especifica\r\n   */\r\n  const printParte = useCallback(\r\n    async (parte: Parte) => {\r\n      if (downloading || !selectedSheet) return;\r\n      setDownloading(true);\r\n\r\n      showToast(\r\n        `Preparando impressão \"${selectedSheet.title}\" - ${parte.instrumento}...`\r\n      );\r\n\r\n      try {\r\n        const response = await fetch(\r\n          `${API_BASE_URL}/api/download/parte/${parte.id}`,\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${Storage.get<string | null>(\"authToken\", null)}`,\r\n            },\r\n          }\r\n        );\r\n\r\n        if (response.ok) {\r\n          const blob = await response.blob();\r\n          const blobUrl = URL.createObjectURL(blob);\r\n          const printWindow = window.open(blobUrl, \"_blank\");\r\n          if (printWindow) {\r\n            printWindow.onload = () => {\r\n              printWindow.print();\r\n            };\r\n          }\r\n          showToast(\"Abrindo impressão...\");\r\n        } else {\r\n          const error = await response.json().catch(() => ({}));\r\n          showToast(\r\n            (error as { error?: string }).error ||\r\n              \"Erro ao preparar impressão\",\r\n            \"error\"\r\n          );\r\n        }\r\n      } catch (e) {\r\n        console.error(\"Erro na impressao:\", e);\r\n        showToast(\"Erro ao preparar impressão\", \"error\");\r\n      }\r\n\r\n      setDownloading(false);\r\n    },\r\n    [downloading, selectedSheet, showToast]\r\n  );\r\n\r\n  /**\r\n   * Inicia fluxo de impressao para um instrumento\r\n   */\r\n  const handlePrintInstrument = useCallback(\r\n    (instrument: string) => {\r\n      const correspondentes = findPartesCorrespondentes(instrument, partes);\r\n\r\n      if (correspondentes.length === 0) {\r\n        showToast(\"Parte não encontrada para impressão\", \"error\");\r\n      } else if (correspondentes.length === 1) {\r\n        printParte(correspondentes[0]);\r\n      } else {\r\n        // Usa primeira parte para simplicidade\r\n        printParte(correspondentes[0]);\r\n      }\r\n    },\r\n    [partes, printParte, showToast]\r\n  );\r\n\r\n  /**\r\n   * Visualiza uma parte especifica (abre no modal embutido)\r\n   */\r\n  const viewParte = useCallback(\r\n    async (parte: Parte) => {\r\n      if (downloading || !selectedSheet) return;\r\n      setDownloading(true);\r\n\r\n      showToast(\r\n        `Carregando \"${selectedSheet.title}\" - ${parte.instrumento}...`\r\n      );\r\n\r\n      try {\r\n        const response = await fetch(\r\n          `${API_BASE_URL}/api/download/parte/${parte.id}`,\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${Storage.get<string | null>(\"authToken\", null)}`,\r\n            },\r\n          }\r\n        );\r\n\r\n        if (response.ok) {\r\n          const blob = await response.blob();\r\n          const blobUrl = URL.createObjectURL(blob);\r\n\r\n          // Abre no modal embutido\r\n          setPdfViewer({\r\n            isOpen: true,\r\n            url: blobUrl,\r\n            title: selectedSheet.title,\r\n            instrument: parte.instrumento,\r\n          });\r\n        } else {\r\n          const error = await response.json().catch(() => ({}));\r\n          showToast(\r\n            (error as { error?: string }).error || \"Erro ao abrir arquivo\",\r\n            \"error\"\r\n          );\r\n        }\r\n      } catch (e) {\r\n        console.error(\"Erro ao visualizar:\", e);\r\n        showToast(\"Erro ao abrir arquivo\", \"error\");\r\n      }\r\n\r\n      setDownloading(false);\r\n    },\r\n    [downloading, selectedSheet, showToast]\r\n  );\r\n\r\n  /**\r\n   * Fecha o visualizador de PDF embutido\r\n   */\r\n  const closePdfViewer = useCallback(() => {\r\n    // Revogar URL do blob para liberar memoria\r\n    if (pdfViewer.url) {\r\n      URL.revokeObjectURL(pdfViewer.url);\r\n    }\r\n    setPdfViewer({\r\n      isOpen: false,\r\n      url: null,\r\n      title: \"\",\r\n      instrument: \"\",\r\n    });\r\n  }, [pdfViewer.url]);\r\n\r\n  /**\r\n   * Inicia fluxo de visualizacao para um instrumento\r\n   */\r\n  const handleViewInstrument = useCallback(\r\n    (instrument: string) => {\r\n      const correspondentes = findPartesCorrespondentes(instrument, partes);\r\n\r\n      if (correspondentes.length === 0) {\r\n        showToast(\"Parte não encontrada\", \"error\");\r\n      } else if (correspondentes.length === 1) {\r\n        viewParte(correspondentes[0]);\r\n      } else {\r\n        viewParte(correspondentes[0]);\r\n      }\r\n    },\r\n    [partes, viewParte, showToast]\r\n  );\r\n\r\n  /**\r\n   * Verifica se o navegador suporta compartilhamento de arquivos\r\n   */\r\n  const canShareFiles = useCallback((): boolean => {\r\n    if (!navigator.share || !navigator.canShare) return false;\r\n    // Testa se pode compartilhar arquivos PDF\r\n    const testFile = new File([\"\"], \"test.pdf\", { type: \"application/pdf\" });\r\n    return navigator.canShare({ files: [testFile] });\r\n  }, []);\r\n\r\n  /**\r\n   * Compartilha uma parte especifica via Web Share API\r\n   */\r\n  const shareParte = useCallback(\r\n    async (parte: Parte) => {\r\n      if (downloading || !selectedSheet) return;\r\n      setDownloading(true);\r\n\r\n      showToast(\r\n        `Preparando \"${selectedSheet.title}\" - ${parte.instrumento}...`\r\n      );\r\n\r\n      try {\r\n        const response = await fetch(\r\n          `${API_BASE_URL}/api/download/parte/${parte.id}`,\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${Storage.get<string | null>(\"authToken\", null)}`,\r\n            },\r\n          }\r\n        );\r\n\r\n        if (response.ok) {\r\n          const blob = await response.blob();\r\n          const filename = `${selectedSheet.title} - ${parte.instrumento}.pdf`;\r\n          const file = new File([blob], filename, {\r\n            type: \"application/pdf\",\r\n          });\r\n\r\n          // Verifica se pode compartilhar arquivos\r\n          if (navigator.canShare && navigator.canShare({ files: [file] })) {\r\n            await navigator.share({\r\n              files: [file],\r\n              title: `${selectedSheet.title} - ${parte.instrumento}`,\r\n              text: `Partitura: ${selectedSheet.title}\\nParte: ${parte.instrumento}`,\r\n            });\r\n            showToast(\"Compartilhado com sucesso!\");\r\n          } else {\r\n            // Fallback: baixa o arquivo se nao suportar compartilhamento\r\n            showToast(\r\n              \"Compartilhamento nao suportado. Baixando arquivo...\",\r\n              \"error\"\r\n            );\r\n            const pdfBlob = new Blob([blob], { type: \"application/pdf\" });\r\n            saveBlob(pdfBlob, filename);\r\n          }\r\n        } else {\r\n          const error = await response.json().catch(() => ({}));\r\n          showToast(\r\n            (error as { error?: string }).error ||\r\n              \"Erro ao preparar arquivo\",\r\n            \"error\"\r\n          );\r\n        }\r\n      } catch (e) {\r\n        // AbortError acontece quando usuario cancela o share\r\n        if ((e as DOMException).name !== \"AbortError\") {\r\n          console.error(\"Erro no compartilhamento:\", e);\r\n          showToast(\"Erro ao compartilhar arquivo\", \"error\");\r\n        }\r\n      }\r\n\r\n      setDownloading(false);\r\n    },\r\n    [downloading, selectedSheet, showToast]\r\n  );\r\n\r\n  /**\r\n   * Inicia fluxo de compartilhamento para um instrumento\r\n   */\r\n  const handleShareInstrument = useCallback(\r\n    (instrument: string) => {\r\n      const correspondentes = findPartesCorrespondentes(instrument, partes);\r\n\r\n      if (correspondentes.length === 0) {\r\n        showToast(\"Parte não encontrada para compartilhar\", \"error\");\r\n      } else if (correspondentes.length === 1) {\r\n        shareParte(correspondentes[0]);\r\n      } else {\r\n        // Usa primeira parte para simplicidade\r\n        shareParte(correspondentes[0]);\r\n      }\r\n    },\r\n    [partes, shareParte, showToast]\r\n  );\r\n\r\n  return {\r\n    // State\r\n    downloading,\r\n    confirmInstrument,\r\n    selectedParte,\r\n    showPartePicker,\r\n    partesDisponiveis,\r\n    pdfViewer,\r\n\r\n    // Actions\r\n    downloadParteDireta,\r\n    handleSelectInstrument,\r\n    handleSelectParteEspecifica,\r\n    handleConfirmDownload,\r\n    handleCancelDownload,\r\n    closePartePicker,\r\n    printParte,\r\n    handlePrintInstrument,\r\n    viewParte,\r\n    handleViewInstrument,\r\n    closePdfViewer,\r\n    shareParte,\r\n    handleShareInstrument,\r\n    canShareFiles,\r\n\r\n    // Utilities\r\n    findPartesCorrespondentes: (inst: string) =>\r\n      findPartesCorrespondentes(inst, partes),\r\n    findParteExata: (inst: string) => findParteExata(inst, partes),\r\n  };\r\n};\r\n\r\nexport default useSheetDownload;\r\n","\"use client\";\r\n\r\n// ===== PARTE PICKER MODAL =====\r\n// Modal para selecao quando existem multiplas partes do mesmo instrumento\r\n// Ex: \"Trompete Bb 1\", \"Trompete Bb 2\"\r\n\r\nimport type { Parte } from \"@hooks/useSheetDownload\";\r\n\r\ninterface PartePickerProps {\r\n  isOpen: boolean;\r\n  partes: Parte[];\r\n  instrumentName?: string;\r\n  downloading?: boolean;\r\n  onSelectParte: (parte: Parte) => void;\r\n  onClose: () => void;\r\n}\r\n\r\nconst PartePicker = ({\r\n  isOpen,\r\n  partes,\r\n  instrumentName = \"\",\r\n  downloading = false,\r\n  onSelectParte,\r\n  onClose,\r\n}: PartePickerProps) => {\r\n  if (!isOpen || partes.length === 0) return null;\r\n\r\n  return (\r\n    <>\r\n      {/* Overlay */}\r\n      <div\r\n        onClick={onClose}\r\n        role=\"presentation\"\r\n        style={{\r\n          position: \"fixed\",\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: \"rgba(0,0,0,0.6)\",\r\n          zIndex: 2002,\r\n          animation: \"fadeIn 0.15s ease\",\r\n        }}\r\n      />\r\n\r\n      {/* Modal */}\r\n      <div\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n        aria-labelledby=\"parte-picker-title\"\r\n        style={{\r\n          position: \"fixed\",\r\n          top: \"50%\",\r\n          left: \"50%\",\r\n          transform: \"translate(-50%, -50%)\",\r\n          background: \"var(--bg-card)\",\r\n          borderRadius: \"20px\",\r\n          padding: \"24px\",\r\n          zIndex: 2003,\r\n          width: \"340px\",\r\n          maxWidth: \"90vw\",\r\n          boxShadow: \"0 25px 50px rgba(0,0,0,0.4)\",\r\n          animation: \"scaleIn 0.25s cubic-bezier(0.16, 1, 0.3, 1)\",\r\n        }}\r\n      >\r\n        {/* Header */}\r\n        <div style={{ textAlign: \"center\", marginBottom: \"20px\" }}>\r\n          <div\r\n            style={{\r\n              width: \"56px\",\r\n              height: \"56px\",\r\n              borderRadius: \"50%\",\r\n              background:\r\n                \"linear-gradient(145deg, #722F37 0%, #5C1A1B 100%)\",\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\",\r\n              margin: \"0 auto 12px\",\r\n              boxShadow: \"0 4px 12px rgba(114, 47, 55, 0.3)\",\r\n            }}\r\n          >\r\n            <svg\r\n              width=\"24\"\r\n              height=\"24\"\r\n              viewBox=\"0 0 24 24\"\r\n              fill=\"none\"\r\n              stroke=\"#F4E4BC\"\r\n              strokeWidth=\"2\"\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              aria-hidden=\"true\"\r\n            >\r\n              <path d=\"M9 18V5l12-2v13\" />\r\n              <circle cx=\"6\" cy=\"18\" r=\"3\" />\r\n              <circle cx=\"18\" cy=\"16\" r=\"3\" />\r\n            </svg>\r\n          </div>\r\n          <h3\r\n            id=\"parte-picker-title\"\r\n            style={{\r\n              fontFamily: \"var(--font-sans)\",\r\n              fontSize: \"18px\",\r\n              fontWeight: \"700\",\r\n              color: \"var(--text-primary)\",\r\n              marginBottom: \"6px\",\r\n            }}\r\n          >\r\n            Escolha sua parte\r\n          </h3>\r\n          <p\r\n            style={{\r\n              fontFamily: \"var(--font-sans)\",\r\n              fontSize: \"13px\",\r\n              color: \"var(--text-muted)\",\r\n            }}\r\n          >\r\n            Encontramos {partes.length} partes de{\" \"}\r\n            <strong style={{ color: \"var(--accent)\" }}>\r\n              {instrumentName}\r\n            </strong>\r\n          </p>\r\n        </div>\r\n\r\n        {/* Lista de partes */}\r\n        <div\r\n          role=\"list\"\r\n          style={{\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            gap: \"8px\",\r\n            marginBottom: \"20px\",\r\n            maxHeight: \"200px\",\r\n            overflowY: \"auto\",\r\n          }}\r\n        >\r\n          {partes.map((parte, idx) => (\r\n            <button\r\n              key={String(parte.id)}\r\n              role=\"listitem\"\r\n              onClick={() => onSelectParte(parte)}\r\n              disabled={downloading}\r\n              aria-label={`Baixar ${parte.instrumento}`}\r\n              style={{\r\n                display: \"flex\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"space-between\",\r\n                padding: \"14px 16px\",\r\n                borderRadius: \"12px\",\r\n                background: \"var(--bg-secondary)\",\r\n                border: \"1px solid var(--border)\",\r\n                color: \"var(--text-primary)\",\r\n                fontFamily: \"var(--font-sans)\",\r\n                fontSize: \"14px\",\r\n                fontWeight: \"500\",\r\n                cursor: downloading ? \"wait\" : \"pointer\",\r\n                transition: \"all 0.2s ease\",\r\n                opacity: downloading ? 0.6 : 1,\r\n              }}\r\n            >\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  alignItems: \"center\",\r\n                  gap: \"12px\",\r\n                }}\r\n              >\r\n                <span\r\n                  style={{\r\n                    width: \"28px\",\r\n                    height: \"28px\",\r\n                    borderRadius: \"50%\",\r\n                    background: \"rgba(212, 175, 55, 0.15)\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    fontSize: \"12px\",\r\n                    fontWeight: \"700\",\r\n                    color: \"var(--accent)\",\r\n                  }}\r\n                >\r\n                  {idx + 1}\r\n                </span>\r\n                <span>{parte.instrumento}</span>\r\n              </div>\r\n              <svg\r\n                width=\"18\"\r\n                height=\"18\"\r\n                viewBox=\"0 0 24 24\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                strokeWidth=\"2\"\r\n                aria-hidden=\"true\"\r\n              >\r\n                <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3\" />\r\n              </svg>\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Botao cancelar */}\r\n        <button\r\n          onClick={onClose}\r\n          style={{\r\n            width: \"100%\",\r\n            padding: \"12px\",\r\n            borderRadius: \"10px\",\r\n            background: \"transparent\",\r\n            border: \"1px solid var(--border)\",\r\n            color: \"var(--text-muted)\",\r\n            fontFamily: \"var(--font-sans)\",\r\n            fontSize: \"14px\",\r\n            fontWeight: \"500\",\r\n            cursor: \"pointer\",\r\n          }}\r\n        >\r\n          Cancelar\r\n        </button>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PartePicker;\r\n","\"use client\";\r\n\r\n// ===== DOWNLOAD CONFIRM MODAL =====\r\n// Modal de confirmacao de download de partitura\r\n\r\ninterface DownloadConfirmProps {\r\n  isOpen: boolean;\r\n  instrumentName?: string;\r\n  downloading?: boolean;\r\n  onConfirm: () => void;\r\n  onCancel: () => void;\r\n}\r\n\r\nconst DownloadConfirm = ({\r\n  isOpen,\r\n  instrumentName = \"\",\r\n  downloading = false,\r\n  onConfirm,\r\n  onCancel,\r\n}: DownloadConfirmProps) => {\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <>\r\n      {/* Overlay */}\r\n      <div\r\n        onClick={onCancel}\r\n        role=\"presentation\"\r\n        style={{\r\n          position: \"fixed\",\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          background: \"rgba(0,0,0,0.5)\",\r\n          zIndex: 2002,\r\n          animation: \"fadeIn 0.15s ease\",\r\n        }}\r\n      />\r\n\r\n      {/* Modal */}\r\n      <div\r\n        role=\"alertdialog\"\r\n        aria-modal=\"true\"\r\n        aria-labelledby=\"download-confirm-title\"\r\n        aria-describedby=\"download-confirm-desc\"\r\n        style={{\r\n          position: \"fixed\",\r\n          top: \"50%\",\r\n          left: \"50%\",\r\n          transform: \"translate(-50%, -50%)\",\r\n          background: \"var(--bg-card)\",\r\n          borderRadius: \"16px\",\r\n          padding: \"24px\",\r\n          zIndex: 2003,\r\n          width: \"300px\",\r\n          maxWidth: \"85vw\",\r\n          boxShadow: \"0 20px 40px rgba(0,0,0,0.3)\",\r\n          animation: \"scaleIn 0.25s cubic-bezier(0.16, 1, 0.3, 1)\",\r\n        }}\r\n      >\r\n        <h3\r\n          id=\"download-confirm-title\"\r\n          style={{\r\n            fontFamily: \"var(--font-sans)\",\r\n            fontSize: \"16px\",\r\n            fontWeight: \"700\",\r\n            color: \"var(--text-primary)\",\r\n            marginBottom: \"8px\",\r\n            textAlign: \"center\",\r\n          }}\r\n        >\r\n          Confirmar Download\r\n        </h3>\r\n        <p\r\n          id=\"download-confirm-desc\"\r\n          style={{\r\n            fontFamily: \"var(--font-sans)\",\r\n            fontSize: \"14px\",\r\n            color: \"var(--text-muted)\",\r\n            marginBottom: \"20px\",\r\n            textAlign: \"center\",\r\n          }}\r\n        >\r\n          Baixar partitura de{\" \"}\r\n          <strong style={{ color: \"var(--accent)\" }}>{instrumentName}</strong>?\r\n        </p>\r\n\r\n        {/* Botoes */}\r\n        <div style={{ display: \"flex\", gap: \"10px\" }}>\r\n          <button\r\n            onClick={onCancel}\r\n            style={{\r\n              flex: 1,\r\n              padding: \"12px\",\r\n              borderRadius: \"10px\",\r\n              background: \"var(--bg-secondary)\",\r\n              border: \"1px solid var(--border)\",\r\n              color: \"var(--text-primary)\",\r\n              fontFamily: \"var(--font-sans)\",\r\n              fontSize: \"14px\",\r\n              fontWeight: \"600\",\r\n              cursor: \"pointer\",\r\n            }}\r\n          >\r\n            Cancelar\r\n          </button>\r\n          <button\r\n            onClick={onConfirm}\r\n            disabled={downloading}\r\n            style={{\r\n              flex: 1,\r\n              padding: \"12px\",\r\n              borderRadius: \"10px\",\r\n              background:\r\n                \"linear-gradient(145deg, #722F37 0%, #5C1A1B 100%)\",\r\n              border: \"none\",\r\n              color: \"#F4E4BC\",\r\n              fontFamily: \"var(--font-sans)\",\r\n              fontSize: \"14px\",\r\n              fontWeight: \"600\",\r\n              cursor: downloading ? \"wait\" : \"pointer\",\r\n              opacity: downloading ? 0.6 : 1,\r\n            }}\r\n          >\r\n            {downloading ? \"Baixando...\" : \"Confirmar\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DownloadConfirm;\r\n","\"use client\";\r\n\r\n// ===== INSTRUMENT SELECTOR =====\r\n// Componente de selecao de instrumento para download/impressao/compartilhamento\r\n// NOTA: Lista de instrumentos agora vem do DataContext (API com fallback)\r\n\r\nimport { Icons } from \"@constants/icons\";\r\nimport { useMediaQuery } from \"@hooks/useMediaQuery\";\r\nimport type { CSSProperties } from \"react\";\r\n\r\ninterface ShareCartItem {\r\n  instrument: string;\r\n  parteId?: string | number;\r\n}\r\n\r\ninterface InstrumentSelectorProps {\r\n  isOpen: boolean;\r\n  instruments: string[];\r\n  userInstrument?: string;\r\n  isMaestro?: boolean;\r\n  downloading?: boolean;\r\n  canShare?: boolean;\r\n  shareCart?: ShareCartItem[];\r\n  onToggle: () => void;\r\n  onSelectInstrument: (instrument: string) => void;\r\n  onPrintInstrument?: (instrument: string) => void;\r\n  onViewInstrument?: (instrument: string) => void;\r\n  onShareInstrument?: (instrument: string) => void;\r\n  onAddToCart?: (instrument: string) => void;\r\n  onRemoveFromCart?: (parteId: string | number) => void;\r\n}\r\n\r\nconst InstrumentSelector = ({\r\n  isOpen,\r\n  instruments,\r\n  userInstrument = \"\",\r\n  isMaestro = false,\r\n  downloading = false,\r\n  canShare = false,\r\n  shareCart = [],\r\n  onToggle,\r\n  onSelectInstrument,\r\n  onPrintInstrument,\r\n  onViewInstrument,\r\n  onShareInstrument,\r\n  onAddToCart,\r\n  onRemoveFromCart,\r\n}: InstrumentSelectorProps) => {\r\n  const isMobile = useMediaQuery(\"(max-width: 767px)\");\r\n  // Determina qual instrumento destacar\r\n  const highlightedInstrument = isMaestro ? \"Grade\" : userInstrument;\r\n\r\n  // Estilo dos botoes de acao\r\n  const actionButtonStyle: CSSProperties = {\r\n    padding: \"6px\",\r\n    borderRadius: \"6px\",\r\n    border: \"none\",\r\n    cursor: downloading ? \"wait\" : \"pointer\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    opacity: downloading ? 0.5 : 1,\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Botao para expandir/recolher */}\r\n      <button\r\n        onClick={onToggle}\r\n        aria-expanded={isOpen}\r\n        aria-controls=\"instrument-list\"\r\n        style={{\r\n          width: \"100%\",\r\n          padding: \"12px 14px\",\r\n          borderRadius: isOpen ? \"10px 10px 0 0\" : \"10px\",\r\n          background: \"var(--bg-secondary)\",\r\n          border: \"1px solid var(--border)\",\r\n          borderBottom: isOpen ? \"none\" : \"1px solid var(--border)\",\r\n          color: \"var(--text-primary)\",\r\n          fontFamily: \"var(--font-sans)\",\r\n          fontSize: \"13px\",\r\n          fontWeight: \"600\",\r\n          cursor: \"pointer\",\r\n          display: \"flex\",\r\n          alignItems: \"center\",\r\n          justifyContent: \"space-between\",\r\n        }}\r\n      >\r\n        <div\r\n          style={{ display: \"flex\", alignItems: \"center\", gap: \"8px\" }}\r\n        >\r\n          <div style={{ width: \"16px\", height: \"16px\" }}>\r\n            <Icons.Music />\r\n          </div>\r\n          <span>\r\n            {isMaestro ? \"Escolher Parte\" : \"Outro Instrumento\"}\r\n          </span>\r\n        </div>\r\n        <div\r\n          style={{\r\n            width: \"16px\",\r\n            height: \"16px\",\r\n            transition: \"transform 0.2s ease\",\r\n            transform: isOpen ? \"rotate(180deg)\" : \"rotate(0deg)\",\r\n          }}\r\n        >\r\n          <Icons.ChevronDown />\r\n        </div>\r\n      </button>\r\n\r\n      {/* Lista de instrumentos */}\r\n      {isOpen && (\r\n        <div\r\n          id=\"instrument-list\"\r\n          role=\"listbox\"\r\n          aria-label=\"Lista de instrumentos\"\r\n          style={{\r\n            background: \"var(--bg-secondary)\",\r\n            border: \"1px solid var(--border)\",\r\n            borderTop: \"none\",\r\n            borderRadius: \"0 0 10px 10px\",\r\n            maxHeight: \"200px\",\r\n            overflowY: \"auto\",\r\n            animation: \"expandDown 0.2s ease-out\",\r\n          }}\r\n        >\r\n          {instruments.map((instrument, idx) => {\r\n            const isHighlighted =\r\n              instrument === highlightedInstrument;\r\n            const isInCart = shareCart.some(\r\n              (item) => item.instrument === instrument\r\n            );\r\n\r\n            return (\r\n              <div\r\n                key={instrument}\r\n                role=\"option\"\r\n                aria-selected={isHighlighted}\r\n                style={{\r\n                  width: \"100%\",\r\n                  padding: \"8px 14px\",\r\n                  background: \"transparent\",\r\n                  borderBottom:\r\n                    idx < instruments.length - 1\r\n                      ? \"1px solid var(--border)\"\r\n                      : \"none\",\r\n                  display: \"flex\",\r\n                  alignItems: \"center\",\r\n                  justifyContent: \"space-between\",\r\n                  gap: \"8px\",\r\n                }}\r\n              >\r\n                {/* Nome do instrumento - clicavel para download */}\r\n                <button\r\n                  onClick={() => onSelectInstrument(instrument)}\r\n                  disabled={downloading}\r\n                  style={{\r\n                    flex: 1,\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    gap: \"8px\",\r\n                    minWidth: 0,\r\n                    background: \"transparent\",\r\n                    border: \"none\",\r\n                    padding: \"4px 0\",\r\n                    cursor: downloading ? \"wait\" : \"pointer\",\r\n                    textAlign: \"left\",\r\n                  }}\r\n                >\r\n                  <span\r\n                    style={{\r\n                      color: isHighlighted\r\n                        ? \"var(--accent)\"\r\n                        : \"var(--text-primary)\",\r\n                      fontFamily: \"var(--font-sans)\",\r\n                      fontSize: \"13px\",\r\n                      fontWeight: isHighlighted ? \"600\" : \"500\",\r\n                      whiteSpace: \"nowrap\",\r\n                      overflow: \"hidden\",\r\n                      textOverflow: \"ellipsis\",\r\n                    }}\r\n                  >\r\n                    {instrument}\r\n                  </span>\r\n                  {isHighlighted && (\r\n                    <span\r\n                      style={{\r\n                        fontSize: \"9px\",\r\n                        background: \"rgba(212,175,55,0.2)\",\r\n                        color: \"var(--accent)\",\r\n                        padding: \"2px 6px\",\r\n                        borderRadius: \"4px\",\r\n                        fontWeight: \"700\",\r\n                        flexShrink: 0,\r\n                      }}\r\n                    >\r\n                      {isMaestro ? \"\\u2605\" : \"MEU\"}\r\n                    </span>\r\n                  )}\r\n                </button>\r\n\r\n                {/* Botoes de acao - compactos */}\r\n                <div\r\n                  style={{\r\n                    display: \"flex\",\r\n                    gap: \"3px\",\r\n                    flexShrink: 0,\r\n                  }}\r\n                >\r\n                  {/* Visualizar (mobile) ou Imprimir (desktop) */}\r\n                  {isMobile\r\n                    ? onViewInstrument && (\r\n                        <button\r\n                          onClick={() =>\r\n                            onViewInstrument(instrument)\r\n                          }\r\n                          disabled={downloading}\r\n                          aria-label={`Visualizar ${instrument}`}\r\n                          title=\"Visualizar\"\r\n                          className=\"action-btn\"\r\n                          style={{\r\n                            ...actionButtonStyle,\r\n                            background:\r\n                              \"rgba(52, 152, 219, 0.12)\",\r\n                            color: \"#3498db\",\r\n                            transition: \"all 0.15s ease\",\r\n                          }}\r\n                        >\r\n                          <div\r\n                            style={{\r\n                              width: \"13px\",\r\n                              height: \"13px\",\r\n                            }}\r\n                          >\r\n                            <Icons.Eye />\r\n                          </div>\r\n                        </button>\r\n                      )\r\n                    : onPrintInstrument && (\r\n                        <button\r\n                          onClick={() =>\r\n                            onPrintInstrument(instrument)\r\n                          }\r\n                          disabled={downloading}\r\n                          aria-label={`Imprimir ${instrument}`}\r\n                          title=\"Imprimir\"\r\n                          className=\"action-btn\"\r\n                          style={{\r\n                            ...actionButtonStyle,\r\n                            background:\r\n                              \"rgba(52, 152, 219, 0.12)\",\r\n                            color: \"#3498db\",\r\n                            transition: \"all 0.15s ease\",\r\n                          }}\r\n                        >\r\n                          <div\r\n                            style={{\r\n                              width: \"13px\",\r\n                              height: \"13px\",\r\n                            }}\r\n                          >\r\n                            <Icons.Printer />\r\n                          </div>\r\n                        </button>\r\n                      )}\r\n\r\n                  {/* Compartilhar individual */}\r\n                  {canShare && onShareInstrument && (\r\n                    <button\r\n                      onClick={() =>\r\n                        onShareInstrument(instrument)\r\n                      }\r\n                      disabled={downloading}\r\n                      aria-label={`Enviar ${instrument}`}\r\n                      title=\"Enviar\"\r\n                      className=\"action-btn\"\r\n                      style={{\r\n                        ...actionButtonStyle,\r\n                        background: \"rgba(37, 211, 102, 0.12)\",\r\n                        color: \"#25D366\",\r\n                        transition: \"all 0.15s ease\",\r\n                      }}\r\n                    >\r\n                      <div\r\n                        style={{\r\n                          width: \"13px\",\r\n                          height: \"13px\",\r\n                        }}\r\n                      >\r\n                        <Icons.Share />\r\n                      </div>\r\n                    </button>\r\n                  )}\r\n\r\n                  {/* Adicionar/Remover do carrinho (para envio em lote) */}\r\n                  {onAddToCart && (\r\n                    <button\r\n                      onClick={() => {\r\n                        if (isInCart && onRemoveFromCart) {\r\n                          const cartItem = shareCart.find(\r\n                            (item) =>\r\n                              item.instrument === instrument\r\n                          );\r\n                          if (cartItem && cartItem.parteId !== undefined) {\r\n                            onRemoveFromCart(cartItem.parteId);\r\n                          }\r\n                        } else {\r\n                          onAddToCart(instrument);\r\n                        }\r\n                      }}\r\n                      disabled={downloading}\r\n                      aria-label={\r\n                        isInCart\r\n                          ? `Remover ${instrument} do carrinho`\r\n                          : `Adicionar ${instrument} ao carrinho`\r\n                      }\r\n                      title={\r\n                        isInCart\r\n                          ? \"Remover do carrinho\"\r\n                          : \"Adicionar ao carrinho\"\r\n                      }\r\n                      className=\"action-btn\"\r\n                      style={{\r\n                        ...actionButtonStyle,\r\n                        background: isInCart\r\n                          ? \"rgba(39, 174, 96, 0.2)\"\r\n                          : \"rgba(155, 89, 182, 0.12)\",\r\n                        color: isInCart\r\n                          ? \"#27ae60\"\r\n                          : \"#9b59b6\",\r\n                        transition: \"all 0.15s ease\",\r\n                      }}\r\n                    >\r\n                      <div\r\n                        style={{\r\n                          width: \"13px\",\r\n                          height: \"13px\",\r\n                        }}\r\n                      >\r\n                        {isInCart ? (\r\n                          <Icons.Check />\r\n                        ) : (\r\n                          <Icons.Plus />\r\n                        )}\r\n                      </div>\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default InstrumentSelector;\r\n","\"use client\";\r\n\r\n// ===== NOTIFICATIONS PANEL =====\r\n// Painel de notificacoes de novas partituras\r\n\r\nimport { useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useUI } from \"@contexts/UIContext\";\r\nimport { useData } from \"@contexts/DataContext\";\r\nimport { useNotifications } from \"@contexts/NotificationContext\";\r\nimport { useIsMobile } from \"@hooks/useResponsive\";\r\nimport { Icons } from \"@constants/icons\";\r\nimport EmptyState from \"@components/common/EmptyState\";\r\n\r\ninterface Notification {\r\n  id: string;\r\n  type: string;\r\n  title: string;\r\n  composer: string;\r\n  date: string;\r\n  read: boolean;\r\n}\r\n\r\nconst NotificationsPanel = () => {\r\n  const router = useRouter();\r\n  const { showNotifications, setShowNotifications, theme } = useUI();\r\n  const { sheets } = useData();\r\n  const {\r\n    notifications,\r\n    loading,\r\n    markNotificationAsRead,\r\n    markAllNotificationsAsRead,\r\n    refreshNotifications,\r\n  } = useNotifications();\r\n  const isMobile = useIsMobile();\r\n\r\n  // Recarrega notificacoes quando painel abre\r\n  useEffect(() => {\r\n    if (showNotifications) {\r\n      refreshNotifications();\r\n    }\r\n  }, [showNotifications, refreshNotifications]);\r\n\r\n  // Bloqueia scroll do body quando painel esta aberto (apenas mobile)\r\n  useEffect(() => {\r\n    if (showNotifications && isMobile) {\r\n      document.body.style.overflow = \"hidden\";\r\n      document.body.style.position = \"fixed\";\r\n      document.body.style.width = \"100%\";\r\n      document.body.style.top = `-${window.scrollY}px`;\r\n    } else {\r\n      const scrollY = document.body.style.top;\r\n      document.body.style.overflow = \"\";\r\n      document.body.style.position = \"\";\r\n      document.body.style.width = \"\";\r\n      document.body.style.top = \"\";\r\n      if (scrollY) {\r\n        window.scrollTo(0, parseInt(scrollY || \"0\") * -1);\r\n      }\r\n    }\r\n    return () => {\r\n      document.body.style.overflow = \"\";\r\n      document.body.style.position = \"\";\r\n      document.body.style.width = \"\";\r\n      document.body.style.top = \"\";\r\n    };\r\n  }, [showNotifications, isMobile]);\r\n\r\n  const formatDate = (dateString: string): string => {\r\n    const date = new Date(dateString);\r\n    const now = new Date();\r\n    const diffMs = now.getTime() - date.getTime();\r\n    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\r\n\r\n    if (diffDays < 0) return \"Hoje\";\r\n    if (diffDays === 0) return \"Hoje\";\r\n    if (diffDays === 1) return \"Ontem\";\r\n    if (diffDays < 7) return `${diffDays} dias atras`;\r\n    return date.toLocaleDateString(\"pt-BR\", { day: \"2-digit\", month: \"short\" });\r\n  };\r\n\r\n  const handleNotificationClick = (notification: Notification) => {\r\n    markNotificationAsRead(notification.id);\r\n\r\n    const sheet = sheets.find(\r\n      (s) => s.title.toLowerCase() === notification.title.toLowerCase()\r\n    );\r\n\r\n    if (sheet) {\r\n      router.push(`/acervo/${sheet.category}/${sheet.id}`);\r\n    } else {\r\n      router.push(\"/acervo\");\r\n    }\r\n\r\n    setShowNotifications(false);\r\n  };\r\n\r\n  if (!showNotifications) return null;\r\n\r\n  return (\r\n    <>\r\n      {/* Overlay - so no mobile */}\r\n      {isMobile && (\r\n        <div\r\n          onClick={() => setShowNotifications(false)}\r\n          style={{\r\n            position: \"fixed\",\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            background: \"rgba(0,0,0,0.5)\",\r\n            zIndex: 1000,\r\n            animation: \"fadeIn 0.2s ease\",\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Area clicavel atras do painel no desktop */}\r\n      {!isMobile && (\r\n        <div\r\n          onClick={() => setShowNotifications(false)}\r\n          style={{\r\n            position: \"fixed\",\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            zIndex: 1000,\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* Panel */}\r\n      <div\r\n        style={{\r\n          position: \"fixed\",\r\n          top: isMobile ? \"50%\" : \"70px\",\r\n          left: isMobile ? \"50%\" : \"auto\",\r\n          right: isMobile ? \"auto\" : \"16px\",\r\n          transform: isMobile ? \"translate(-50%, -50%)\" : \"none\",\r\n          width: isMobile ? \"calc(100% - 40px)\" : \"calc(100% - 32px)\",\r\n          maxWidth: \"360px\",\r\n          maxHeight: isMobile ? \"80vh\" : \"70vh\",\r\n          background: \"var(--bg-card)\",\r\n          borderRadius: \"20px\",\r\n          boxShadow: \"0 8px 32px rgba(0,0,0,0.25)\",\r\n          zIndex: 1001,\r\n          overflow: \"hidden\",\r\n          animation: isMobile\r\n            ? \"popIn 0.25s ease\"\r\n            : \"slideUp 0.3s ease\",\r\n          border: \"1px solid var(--border)\",\r\n        }}\r\n      >\r\n        {/* Header */}\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            justifyContent: \"space-between\",\r\n            alignItems: \"center\",\r\n            padding: \"16px 20px\",\r\n            borderBottom: \"1px solid var(--border)\",\r\n          }}\r\n        >\r\n          <h3\r\n            style={{\r\n              fontFamily: \"var(--font-sans)\",\r\n              fontSize: \"18px\",\r\n              fontWeight: \"700\",\r\n              color: \"var(--text-primary)\",\r\n            }}\r\n          >\r\n            Notificações\r\n          </h3>\r\n          {notifications.some((n) => !n.read) && (\r\n            <button\r\n              onClick={markAllNotificationsAsRead}\r\n              style={{\r\n                background: \"none\",\r\n                border: \"none\",\r\n                color: \"var(--primary)\",\r\n                fontSize: \"13px\",\r\n                fontWeight: \"600\",\r\n                cursor: \"pointer\",\r\n                fontFamily: \"var(--font-sans)\",\r\n              }}\r\n            >\r\n              Marcar como lidas\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Lista de notificacoes */}\r\n        <div style={{ maxHeight: \"calc(70vh - 60px)\", overflowY: \"auto\" }}>\r\n          {loading ? (\r\n            <div style={{ padding: \"40px 20px\", textAlign: \"center\" }}>\r\n              <div\r\n                style={{\r\n                  width: \"32px\",\r\n                  height: \"32px\",\r\n                  border: \"3px solid var(--border)\",\r\n                  borderTopColor: \"var(--primary)\",\r\n                  borderRadius: \"50%\",\r\n                  margin: \"0 auto 12px\",\r\n                  animation: \"spin 1s linear infinite\",\r\n                }}\r\n              />\r\n              <p\r\n                style={{\r\n                  fontSize: \"14px\",\r\n                  color: \"var(--text-muted)\",\r\n                  fontFamily: \"var(--font-sans)\",\r\n                }}\r\n              >\r\n                Carregando...\r\n              </p>\r\n            </div>\r\n          ) : notifications.length === 0 ? (\r\n            <EmptyState\r\n              icon={Icons.Music}\r\n              title=\"Nenhuma partitura nova\"\r\n              size=\"small\"\r\n            />\r\n          ) : (\r\n            notifications.map((notification) => (\r\n              <div\r\n                key={notification.id}\r\n                onClick={() => handleNotificationClick(notification)}\r\n                style={{\r\n                  display: \"flex\",\r\n                  alignItems: \"center\",\r\n                  gap: \"12px\",\r\n                  padding: \"14px 20px\",\r\n                  cursor: \"pointer\",\r\n                  background: notification.read\r\n                    ? \"transparent\"\r\n                    : theme === \"dark\"\r\n                      ? \"rgba(212,175,55,0.08)\"\r\n                      : \"rgba(212,175,55,0.1)\",\r\n                  borderBottom: \"1px solid var(--border)\",\r\n                  transition: \"background 0.2s ease\",\r\n                }}\r\n              >\r\n                {/* Icone */}\r\n                <div\r\n                  style={{\r\n                    width: \"40px\",\r\n                    height: \"40px\",\r\n                    borderRadius: \"10px\",\r\n                    background:\r\n                      \"linear-gradient(145deg, #722F37 0%, #5C1A1B 100%)\",\r\n                    display: \"flex\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    flexShrink: 0,\r\n                  }}\r\n                >\r\n                  <div\r\n                    style={{\r\n                      width: \"20px\",\r\n                      height: \"20px\",\r\n                      color: \"#D4AF37\",\r\n                    }}\r\n                  >\r\n                    <Icons.Music />\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Conteudo */}\r\n                <div style={{ flex: 1, minWidth: 0 }}>\r\n                  <p\r\n                    style={{\r\n                      fontSize: \"14px\",\r\n                      fontWeight: notification.read ? \"500\" : \"600\",\r\n                      color: \"var(--text-primary)\",\r\n                      marginBottom: \"2px\",\r\n                      fontFamily: \"var(--font-sans)\",\r\n                      whiteSpace: \"nowrap\",\r\n                      overflow: \"hidden\",\r\n                      textOverflow: \"ellipsis\",\r\n                    }}\r\n                  >\r\n                    {notification.title}\r\n                  </p>\r\n                  <p\r\n                    style={{\r\n                      fontSize: \"13px\",\r\n                      color: \"var(--text-muted)\",\r\n                      fontFamily: \"var(--font-sans)\",\r\n                      whiteSpace: \"nowrap\",\r\n                      overflow: \"hidden\",\r\n                      textOverflow: \"ellipsis\",\r\n                    }}\r\n                  >\r\n                    {notification.composer || \"Compositor desconhecido\"}\r\n                  </p>\r\n                  <p\r\n                    style={{\r\n                      fontSize: \"11px\",\r\n                      color: \"var(--text-muted)\",\r\n                      opacity: 0.6,\r\n                      fontFamily: \"var(--font-sans)\",\r\n                      marginTop: \"2px\",\r\n                    }}\r\n                  >\r\n                    {formatDate(notification.date)}\r\n                  </p>\r\n                </div>\r\n\r\n                {/* Indicador de nao lida */}\r\n                {!notification.read && (\r\n                  <div\r\n                    style={{\r\n                      width: \"8px\",\r\n                      height: \"8px\",\r\n                      borderRadius: \"50%\",\r\n                      background: \"#D4AF37\",\r\n                      flexShrink: 0,\r\n                    }}\r\n                  />\r\n                )}\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default NotificationsPanel;\r\n","\"use client\";\r\n\r\n// ===== SHARE CART MODAL =====\r\n// Modal para revisar e compartilhar multiplas partes de partituras\r\n// Agrupa partes por partitura e permite remover individualmente\r\n// Usa pre-carregamento para habilitar Web Share API\r\n\r\nimport { useState, useCallback, useEffect, useRef } from \"react\";\r\nimport { useUI } from \"@contexts/UIContext\";\r\nimport { Icons } from \"@constants/icons\";\r\nimport { API_BASE_URL } from \"@constants/api\";\r\nimport Storage from \"@lib/storage\";\r\nimport useAnimatedVisibility from \"@hooks/useAnimatedVisibility\";\r\n\r\ninterface GroupedSheet {\r\n  title: string;\r\n  partes: Array<{\r\n    parteId: string | number;\r\n    parteName: string;\r\n    partituraTitle: string;\r\n    downloadUrl: string;\r\n  }>;\r\n}\r\n\r\nconst ShareCartModal = () => {\r\n  const {\r\n    shareCart,\r\n    showShareCart,\r\n    setShowShareCart,\r\n    removeFromShareCart,\r\n    clearShareCart,\r\n    showToast,\r\n  } = useUI();\r\n\r\n  const [isDesktop] = useState(\r\n    typeof window !== \"undefined\" ? window.innerWidth >= 1024 : false\r\n  );\r\n  const [sharing, setSharing] = useState(false);\r\n\r\n  // Estados para pre-carregamento\r\n  const [preparedFiles, setPreparedFiles] = useState<File[]>([]);\r\n  const [preparingProgress, setPreparingProgress] = useState({\r\n    current: 0,\r\n    total: 0,\r\n  });\r\n  const [isPreparing, setIsPreparing] = useState(false);\r\n  const [prepareError, setPrepareError] = useState<string | null>(null);\r\n\r\n  // Ref para controlar cancelamento\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  // Animacao de entrada/saida\r\n  const { shouldRender, isExiting } = useAnimatedVisibility(\r\n    showShareCart,\r\n    250\r\n  );\r\n\r\n  // Agrupa partes por partitura\r\n  const groupedBySheet = shareCart.reduce<Record<string, GroupedSheet>>(\r\n    (acc, item) => {\r\n      const key = item.partituraTitle;\r\n      if (!acc[key]) {\r\n        acc[key] = {\r\n          title: item.partituraTitle,\r\n          partes: [],\r\n        };\r\n      }\r\n      acc[key].partes.push(item);\r\n      return acc;\r\n    },\r\n    {}\r\n  );\r\n\r\n  // Pre-carrega arquivos quando o modal abre ou carrinho muda\r\n  useEffect(() => {\r\n    if (!showShareCart || shareCart.length === 0) {\r\n      // Reset via cleanup-style: schedule microtask to avoid synchronous setState in effect body\r\n      const id = requestAnimationFrame(() => {\r\n        setPreparedFiles([]);\r\n        setPreparingProgress({ current: 0, total: 0 });\r\n        setPrepareError(null);\r\n      });\r\n      return () => cancelAnimationFrame(id);\r\n    }\r\n\r\n    // Cancela carregamento anterior\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n    }\r\n\r\n    const controller = new AbortController();\r\n    abortControllerRef.current = controller;\r\n\r\n    let cancelled = false;\r\n\r\n    const prepareFiles = async () => {\r\n      setIsPreparing(true);\r\n      setPrepareError(null);\r\n      setPreparingProgress({ current: 0, total: shareCart.length });\r\n\r\n      const files: File[] = [];\r\n      const errors: string[] = [];\r\n\r\n      for (let i = 0; i < shareCart.length; i++) {\r\n        if (controller.signal.aborted || cancelled) return;\r\n\r\n        const item = shareCart[i];\r\n        setPreparingProgress({ current: i + 1, total: shareCart.length });\r\n\r\n        try {\r\n          const response = await fetch(\r\n            `${API_BASE_URL}/api/download/parte/${item.parteId}`,\r\n            {\r\n              headers: {\r\n                Authorization: `Bearer ${Storage.get<string | null>(\"authToken\", null)}`,\r\n              },\r\n              signal: controller.signal,\r\n            }\r\n          );\r\n\r\n          if (response.ok) {\r\n            const blob = await response.blob();\r\n            const filename = `${item.partituraTitle} - ${item.parteName}.pdf`;\r\n            files.push(\r\n              new File([blob], filename, { type: \"application/pdf\" })\r\n            );\r\n          } else {\r\n            errors.push(`${item.parteName}: erro ${response.status}`);\r\n          }\r\n        } catch (err: unknown) {\r\n          if (err instanceof Error && err.name === \"AbortError\") return;\r\n          console.error(`Erro ao baixar ${item.parteName}:`, err);\r\n          errors.push(`${item.parteName}: falha`);\r\n        }\r\n      }\r\n\r\n      if (!controller.signal.aborted && !cancelled) {\r\n        setPreparedFiles(files);\r\n        setIsPreparing(false);\r\n        if (errors.length > 0 && files.length === 0) {\r\n          setPrepareError(\"Erro ao preparar arquivos\");\r\n        }\r\n      }\r\n    };\r\n\r\n    prepareFiles();\r\n\r\n    return () => {\r\n      cancelled = true;\r\n      controller.abort();\r\n    };\r\n  }, [showShareCart, shareCart]);\r\n\r\n  // Verifica se Web Share API com arquivos esta disponivel\r\n  const canShareFiles = useCallback(() => {\r\n    try {\r\n      const testFile = new File([\"test\"], \"test.txt\", { type: \"text/plain\" });\r\n      return (\r\n        typeof navigator.canShare === \"function\" &&\r\n        navigator.canShare({ files: [testFile] })\r\n      );\r\n    } catch {\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  // Funcao auxiliar para baixar arquivos via download\r\n  const downloadFiles = useCallback(\r\n    (files: File[]) => {\r\n      showToast(`Baixando ${files.length} arquivo(s)...`);\r\n      files.forEach((file, idx) => {\r\n        setTimeout(() => {\r\n          const url = URL.createObjectURL(file);\r\n          const link = document.createElement(\"a\");\r\n          link.href = url;\r\n          link.download = file.name;\r\n          document.body.appendChild(link);\r\n          link.click();\r\n          document.body.removeChild(link);\r\n          URL.revokeObjectURL(url);\r\n\r\n          if (idx === files.length - 1) {\r\n            setTimeout(() => {\r\n              showToast(\"Downloads concluidos!\");\r\n              clearShareCart();\r\n              setShowShareCart(false);\r\n            }, 500);\r\n          }\r\n        }, idx * 500);\r\n      });\r\n    },\r\n    [showToast, clearShareCart, setShowShareCart]\r\n  );\r\n\r\n  // Compartilha arquivos pre-carregados (chamado direto no clique)\r\n  const handleShareAll = useCallback(() => {\r\n    if (sharing || preparedFiles.length === 0) return;\r\n    setSharing(true);\r\n\r\n    if (canShareFiles() && navigator.canShare({ files: preparedFiles })) {\r\n      navigator\r\n        .share({\r\n          files: preparedFiles,\r\n          title: `${preparedFiles.length} partituras`,\r\n          text: `Partituras: ${shareCart.map((p) => p.partituraTitle).join(\", \")}`,\r\n        })\r\n        .then(() => {\r\n          showToast(\"Compartilhado com sucesso!\");\r\n          clearShareCart();\r\n          setShowShareCart(false);\r\n        })\r\n        .catch((err: Error) => {\r\n          if (err.name !== \"AbortError\") {\r\n            console.error(\"Erro no share:\", err);\r\n            downloadFiles(preparedFiles);\r\n          }\r\n        })\r\n        .finally(() => {\r\n          setSharing(false);\r\n        });\r\n    } else {\r\n      downloadFiles(preparedFiles);\r\n      setSharing(false);\r\n    }\r\n  }, [\r\n    sharing,\r\n    preparedFiles,\r\n    shareCart,\r\n    canShareFiles,\r\n    clearShareCart,\r\n    setShowShareCart,\r\n    showToast,\r\n    downloadFiles,\r\n  ]);\r\n\r\n  const handleClose = () => setShowShareCart(false);\r\n\r\n  // Calcula estado do botao\r\n  const isReady = preparedFiles.length > 0 && !isPreparing;\r\n  const progressPercent =\r\n    preparingProgress.total > 0\r\n      ? Math.round(\r\n          (preparingProgress.current / preparingProgress.total) * 100\r\n        )\r\n      : 0;\r\n\r\n  if (!shouldRender) return null;\r\n\r\n  return (\r\n    <>\r\n      {/* Overlay */}\r\n      <div\r\n        onClick={handleClose}\r\n        role=\"presentation\"\r\n        style={{\r\n          position: \"fixed\",\r\n          inset: 0,\r\n          background: \"rgba(0,0,0,0.6)\",\r\n          backdropFilter: \"blur(4px)\",\r\n          WebkitBackdropFilter: \"blur(4px)\",\r\n          zIndex: 2000,\r\n          animation: isExiting\r\n            ? \"modalBackdropOut 0.25s ease forwards\"\r\n            : \"modalBackdropIn 0.2s ease\",\r\n        }}\r\n      />\r\n\r\n      {/* Modal */}\r\n      <div\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n        aria-labelledby=\"share-cart-title\"\r\n        style={{\r\n          position: \"fixed\",\r\n          ...(isDesktop\r\n            ? {\r\n                top: \"50%\",\r\n                left: \"50%\",\r\n                transform: \"translate(-50%, -50%)\",\r\n                width: \"400px\",\r\n                maxWidth: \"90vw\",\r\n                borderRadius: \"20px\",\r\n                animation: isExiting\r\n                  ? \"modalScaleOut 0.25s ease forwards\"\r\n                  : \"popIn 0.3s cubic-bezier(0.16, 1, 0.3, 1)\",\r\n              }\r\n            : {\r\n                bottom: 0,\r\n                left: 0,\r\n                right: 0,\r\n                borderRadius: \"24px 24px 0 0\",\r\n                animation: isExiting\r\n                  ? \"slideDownModal 0.25s ease forwards\"\r\n                  : \"slideUpModal 0.35s cubic-bezier(0.16, 1, 0.3, 1)\",\r\n              }),\r\n          background: \"var(--bg-card)\",\r\n          zIndex: 2001,\r\n          maxHeight: isDesktop ? \"80vh\" : \"85vh\",\r\n          overflow: \"hidden\",\r\n          boxShadow: \"0 25px 50px -12px rgba(0, 0, 0, 0.25)\",\r\n          display: \"flex\",\r\n          flexDirection: \"column\",\r\n        }}\r\n      >\r\n        {/* Handle - apenas mobile */}\r\n        {!isDesktop && (\r\n          <div\r\n            style={{\r\n              width: \"40px\",\r\n              height: \"4px\",\r\n              background: \"var(--border)\",\r\n              borderRadius: \"2px\",\r\n              margin: \"12px auto\",\r\n              flexShrink: 0,\r\n            }}\r\n          />\r\n        )}\r\n\r\n        {/* Header */}\r\n        <div\r\n          style={{\r\n            padding: \"16px 20px\",\r\n            borderBottom: \"1px solid var(--border)\",\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"space-between\",\r\n            flexShrink: 0,\r\n          }}\r\n        >\r\n          <div\r\n            style={{ display: \"flex\", alignItems: \"center\", gap: \"10px\" }}\r\n          >\r\n            <div\r\n              style={{\r\n                width: \"36px\",\r\n                height: \"36px\",\r\n                borderRadius: \"10px\",\r\n                background: \"rgba(37, 211, 102, 0.15)\",\r\n                display: \"flex\",\r\n                alignItems: \"center\",\r\n                justifyContent: \"center\",\r\n              }}\r\n            >\r\n              <div\r\n                style={{ width: \"18px\", height: \"18px\", color: \"#25D366\" }}\r\n              >\r\n                <Icons.Share />\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <h2\r\n                id=\"share-cart-title\"\r\n                style={{\r\n                  fontFamily: \"var(--font-sans)\",\r\n                  fontSize: \"16px\",\r\n                  fontWeight: \"700\",\r\n                  color: \"var(--text-primary)\",\r\n                  margin: 0,\r\n                }}\r\n              >\r\n                Carrinho de Envio\r\n              </h2>\r\n              <p\r\n                style={{\r\n                  fontFamily: \"var(--font-sans)\",\r\n                  fontSize: \"12px\",\r\n                  color: \"var(--text-muted)\",\r\n                  margin: 0,\r\n                }}\r\n              >\r\n                {shareCart.length}{\" \"}\r\n                {shareCart.length === 1\r\n                  ? \"parte selecionada\"\r\n                  : \"partes selecionadas\"}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <button\r\n            onClick={handleClose}\r\n            aria-label=\"Fechar\"\r\n            style={{\r\n              width: \"32px\",\r\n              height: \"32px\",\r\n              borderRadius: \"50%\",\r\n              background: \"var(--bg-secondary)\",\r\n              border: \"none\",\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\",\r\n              cursor: \"pointer\",\r\n              color: \"var(--text-muted)\",\r\n            }}\r\n          >\r\n            <div style={{ width: \"16px\", height: \"16px\" }}>\r\n              <Icons.Close />\r\n            </div>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Barra de progresso */}\r\n        {isPreparing && (\r\n          <div\r\n            style={{\r\n              height: \"3px\",\r\n              background: \"var(--bg-secondary)\",\r\n              overflow: \"hidden\",\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                height: \"100%\",\r\n                width: `${progressPercent}%`,\r\n                background:\r\n                  \"linear-gradient(90deg, #25D366 0%, #128C7E 100%)\",\r\n                transition: \"width 0.3s ease\",\r\n              }}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {/* Lista de partes */}\r\n        <div\r\n          style={{\r\n            flex: 1,\r\n            overflowY: \"auto\",\r\n            padding: \"12px 20px\",\r\n          }}\r\n        >\r\n          {Object.entries(groupedBySheet).map(([key, sheet]) => (\r\n            <div key={key} style={{ marginBottom: \"16px\" }}>\r\n              {/* Titulo da partitura */}\r\n              <p\r\n                style={{\r\n                  fontFamily: \"var(--font-sans)\",\r\n                  fontSize: \"11px\",\r\n                  fontWeight: \"600\",\r\n                  color: \"var(--text-muted)\",\r\n                  textTransform: \"uppercase\",\r\n                  letterSpacing: \"0.5px\",\r\n                  marginBottom: \"8px\",\r\n                }}\r\n              >\r\n                {sheet.title}\r\n              </p>\r\n\r\n              {/* Partes */}\r\n              <div\r\n                style={{\r\n                  display: \"flex\",\r\n                  flexDirection: \"column\",\r\n                  gap: \"6px\",\r\n                }}\r\n              >\r\n                {sheet.partes.map((item) => (\r\n                  <div\r\n                    key={item.parteId}\r\n                    style={{\r\n                      display: \"flex\",\r\n                      alignItems: \"center\",\r\n                      justifyContent: \"space-between\",\r\n                      padding: \"10px 12px\",\r\n                      background: \"var(--bg-secondary)\",\r\n                      borderRadius: \"10px\",\r\n                    }}\r\n                  >\r\n                    <div\r\n                      style={{\r\n                        display: \"flex\",\r\n                        alignItems: \"center\",\r\n                        gap: \"8px\",\r\n                      }}\r\n                    >\r\n                      <div\r\n                        style={{\r\n                          width: \"14px\",\r\n                          height: \"14px\",\r\n                          color: \"var(--accent)\",\r\n                        }}\r\n                      >\r\n                        <Icons.Music />\r\n                      </div>\r\n                      <span\r\n                        style={{\r\n                          fontFamily: \"var(--font-sans)\",\r\n                          fontSize: \"13px\",\r\n                          fontWeight: \"500\",\r\n                          color: \"var(--text-primary)\",\r\n                        }}\r\n                      >\r\n                        {item.parteName}\r\n                      </span>\r\n                    </div>\r\n\r\n                    <button\r\n                      onClick={() => removeFromShareCart(item.parteId)}\r\n                      aria-label={`Remover ${item.parteName}`}\r\n                      style={{\r\n                        width: \"28px\",\r\n                        height: \"28px\",\r\n                        borderRadius: \"7px\",\r\n                        background: \"rgba(231, 76, 60, 0.1)\",\r\n                        border: \"none\",\r\n                        display: \"flex\",\r\n                        alignItems: \"center\",\r\n                        justifyContent: \"center\",\r\n                        cursor: \"pointer\",\r\n                        color: \"#e74c3c\",\r\n                      }}\r\n                    >\r\n                      <div style={{ width: \"14px\", height: \"14px\" }}>\r\n                        <Icons.Close />\r\n                      </div>\r\n                    </button>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          ))}\r\n\r\n          {shareCart.length === 0 && (\r\n            <div\r\n              style={{\r\n                textAlign: \"center\",\r\n                padding: \"40px 20px\",\r\n                color: \"var(--text-muted)\",\r\n              }}\r\n            >\r\n              <div\r\n                style={{\r\n                  width: \"48px\",\r\n                  height: \"48px\",\r\n                  margin: \"0 auto 12px\",\r\n                  opacity: 0.4,\r\n                }}\r\n              >\r\n                <Icons.Music />\r\n              </div>\r\n              <p\r\n                style={{\r\n                  fontFamily: \"var(--font-sans)\",\r\n                  fontSize: \"14px\",\r\n                }}\r\n              >\r\n                Nenhuma parte selecionada\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {prepareError && (\r\n            <p\r\n              style={{\r\n                fontFamily: \"var(--font-sans)\",\r\n                fontSize: \"12px\",\r\n                color: \"#e74c3c\",\r\n                textAlign: \"center\",\r\n                marginTop: \"8px\",\r\n              }}\r\n            >\r\n              {prepareError}\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer com botoes */}\r\n        <div\r\n          style={{\r\n            padding: \"16px 20px\",\r\n            borderTop: \"1px solid var(--border)\",\r\n            display: \"flex\",\r\n            gap: \"10px\",\r\n            flexShrink: 0,\r\n          }}\r\n        >\r\n          <button\r\n            onClick={clearShareCart}\r\n            disabled={shareCart.length === 0}\r\n            style={{\r\n              flex: 1,\r\n              padding: \"12px\",\r\n              borderRadius: \"10px\",\r\n              background: \"var(--bg-secondary)\",\r\n              border: \"1px solid var(--border)\",\r\n              color:\r\n                shareCart.length === 0\r\n                  ? \"var(--text-muted)\"\r\n                  : \"var(--text-primary)\",\r\n              fontFamily: \"var(--font-sans)\",\r\n              fontSize: \"13px\",\r\n              fontWeight: \"600\",\r\n              cursor: shareCart.length === 0 ? \"not-allowed\" : \"pointer\",\r\n              opacity: shareCart.length === 0 ? 0.5 : 1,\r\n            }}\r\n          >\r\n            Limpar\r\n          </button>\r\n\r\n          <button\r\n            onClick={handleShareAll}\r\n            disabled={!isReady || sharing}\r\n            style={{\r\n              flex: 2,\r\n              padding: \"12px\",\r\n              borderRadius: \"10px\",\r\n              background: !isReady\r\n                ? \"var(--bg-secondary)\"\r\n                : \"linear-gradient(145deg, #25D366 0%, #128C7E 100%)\",\r\n              border: \"none\",\r\n              color: !isReady ? \"var(--text-muted)\" : \"#FFFFFF\",\r\n              fontFamily: \"var(--font-sans)\",\r\n              fontSize: \"13px\",\r\n              fontWeight: \"600\",\r\n              cursor: !isReady || sharing ? \"not-allowed\" : \"pointer\",\r\n              display: \"flex\",\r\n              alignItems: \"center\",\r\n              justifyContent: \"center\",\r\n              gap: \"8px\",\r\n              boxShadow: !isReady\r\n                ? \"none\"\r\n                : \"0 4px 12px rgba(37, 211, 102, 0.3)\",\r\n              opacity: !isReady ? 0.5 : 1,\r\n            }}\r\n          >\r\n            <div style={{ width: \"16px\", height: \"16px\" }}>\r\n              {isPreparing || sharing ? (\r\n                <div\r\n                  style={{\r\n                    width: \"16px\",\r\n                    height: \"16px\",\r\n                    border: \"2px solid rgba(255,255,255,0.3)\",\r\n                    borderTopColor: !isReady ? \"var(--text-muted)\" : \"#fff\",\r\n                    borderRadius: \"50%\",\r\n                    animation: \"spin 0.8s linear infinite\",\r\n                  }}\r\n                />\r\n              ) : (\r\n                <Icons.Share />\r\n              )}\r\n            </div>\r\n            {isPreparing\r\n              ? `Preparando... ${progressPercent}%`\r\n              : sharing\r\n                ? \"Enviando...\"\r\n                : \"Compartilhar\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ShareCartModal;\r\n"],"names":[],"mappings":"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"}