(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,22589,e=>{"use strict";var t=e.i(89123),a=e.i(65590),r=e.i(40915),o=e.i(7690),i=e.i(97079),s=e.i(97312);let n=0,l=async(e,t="")=>{let a=[];if(e.isFile){let r=await new Promise(t=>e.file(t));a.push({file:r,path:t+r.name,fullPath:t})}else if(e.isDirectory){let r=e.createReader();for(let o of(await new Promise(e=>{let t=[],a=()=>{r.readEntries(r=>{0===r.length?e(t):(t.push(...r),a())})};a()}))){let r=await l(o,t+e.name+"/");a.push(...r)}}return a},d=e=>{let t=new Map;for(let a of e.filter(e=>e.file.name.toLowerCase().endsWith(".pdf"))){let e=(a.path||"").replace(/\\/g,"/").split("/");e.pop();let r=e.join("/");t.has(r)||t.set(r,[]),t.get(r).push(a)}return t},p=(e,t,a=[],r=[])=>{let o=(e||"").replace(/\\/g,"/"),l=o.split("/").filter(e=>e.trim()),d=l[l.length-1]||"Pasta sem nome",p=(0,s.analisarMetadados)(o,d,a),c=t.map(({file:e})=>{let{instrumento:t,reconhecido:a}=(0,i.extrairInstrumento)(e.name);return{file:e,nomeOriginal:e.name,instrumento:t,reconhecido:a}}),x={id:(n++,`pasta-${Date.now()}-${n}-${Math.random().toString(36).substr(2,9)}`),caminho:o,nomePasta:d,titulo:p.titulo,categoria:p.categoria||"",categoriaConfianca:p.categoriaConfianca,categoriaFonte:p.categoriaFonte,compositor:p.compositor,arranjador:p.arranjador,arquivos:c,selecionada:!0,status:"ready",statusMotivo:null,duplicada:!1},{status:u,motivo:h,duplicada:g}=((e,t=[])=>{let{arquivos:a,categoria:r,titulo:o}=e;if(!a||0===a.length)return{status:"problem",motivo:"Nenhum arquivo PDF encontrado",duplicada:!1};if(!o||""===o.trim())return{status:"problem",motivo:"Titulo nao detectado",duplicada:!1};let{duplicada:s}=((e,t=[])=>{if(!e||0===t.length)return{duplicada:!1,partituraExistente:null};let a=(0,i.normalizarTexto)(e);for(let e of t)if(a===(0,i.normalizarTexto)(e.titulo||""))return{duplicada:!0,partituraExistente:e};return{duplicada:!1,partituraExistente:null}})(o,t);if(s)return{status:"problem",motivo:"Ja existe no acervo",duplicada:!0};let n=a.filter(e=>!e.reconhecido).length,l=a.length;return r?n/l*100>50?{status:"attention",motivo:`${n} de ${l} instrumentos nao reconhecidos`,duplicada:!1}:n>0?{status:"attention",motivo:`${n} instrumento(s) nao reconhecido(s)`,duplicada:!1}:{status:"ready",motivo:null,duplicada:!1}:{status:"attention",motivo:"Categoria nao detectada",duplicada:!1}})(x,r);return x.status=u,x.statusMotivo=h,x.duplicada=g,x},c=e=>e.reduce((e,t)=>(e.total++,"ready"===t.status?e.prontas++:"attention"===t.status?e.atencao++:"problem"===t.status&&e.problemas++,e.totalArquivos+=t.arquivos.length,e.instrumentosReconhecidos+=t.arquivos.filter(e=>e.reconhecido).length,e.instrumentosNaoReconhecidos+=t.arquivos.filter(e=>!e.reconhecido).length,e),{total:0,prontas:0,atencao:0,problemas:0,totalArquivos:0,instrumentosReconhecidos:0,instrumentosNaoReconhecidos:0}),x=async(e,t=[],a=[],r=null)=>{let o=[];if(Array.isArray(e))for(let t of e){let e=await l(t,"");o.push(...e)}else for(let t=0;t<e.length;t++){let a=e[t].webkitGetAsEntry?.();if(a){let e=await l(a,"");o.push(...e)}}let i=d(o),s=i.size,n=0,x=[];for(let[e,o]of i){let i=p(e,o,t,a);x.push(i),n++,r&&r({processadas:n,total:s,percentual:Math.round(n/s*100),pastaAtual:e})}let u=c(x);return{pastas:x,estatisticas:u}},u=async(e,t=[],a=[],r=null)=>{let o=d(Array.from(e).filter(e=>e.name.toLowerCase().endsWith(".pdf")).map(e=>({file:e,path:e.webkitRelativePath||e.name,fullPath:e.webkitRelativePath?e.webkitRelativePath.split("/").slice(0,-1).join("/"):""})).map(e=>({...e,path:e.path}))),i=o.size,s=0,n=[];for(let[e,l]of o){let o=p(e,l,t,a);n.push(o),s++,r&&r({processadas:s,total:i,percentual:Math.round(s/i*100),pastaAtual:e})}let l=c(n);return{pastas:n,estatisticas:l}},h=e=>new Promise(t=>setTimeout(t,e)),g=async e=>{try{let t=new FormData;t.append("titulo",e.titulo?.trim()||e.nomePasta||""),t.append("compositor",e.compositor?.trim()||""),t.append("arranjador",e.arranjador?.trim()||""),t.append("categoria",e.categoria||""),t.append("ano",e.ano||""),t.append("total_arquivos",e.arquivos.length.toString()),e.arquivos.forEach((e,a)=>{t.append(`arquivo_${a}`,e.file),t.append(`instrumento_${a}`,e.instrumento)});let a=await o.API.uploadPastaPartitura(t);return{success:!0,result:a}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Erro desconhecido"}}},m=async(e,t=2,a=1e3)=>{let r,o=0;for(;o<t;){o++;let i=await g(e);if(i.success)return{...i,attempts:o};r=i.error,o<t&&await h(a)}return{success:!1,error:r,attempts:o}},y=async(e,t={},a={})=>{let{onPastaStart:r,onPastaComplete:o,onPastaError:i,onChunkComplete:s,onProgress:n}=t,{chunkSize:l=5,delayBetweenChunks:d=500,retryAttempts:p=2,retryDelay:c=1e3}=a,x=e.filter(e=>e.selecionada),u=x.length;if(0===u)return{resultados:[],estatisticas:{total:0,sucesso:0,erro:0,tempoTotal:0,tempoMedio:0}};let g=((e,t)=>{let a=[];for(let r=0;r<e.length;r+=t)a.push(e.slice(r,r+t));return a})(x,l),y=[],f=0,v=0,b=0,j=Date.now();for(let e=0;e<g.length;e++){for(let t of g[e]){r&&r({pasta:t,processadas:f,total:u});let e=await m(t,p,c);y.push({pastaId:t.id,titulo:t.titulo,caminho:t.caminho,...e}),f++,e.success?(v++,o&&o({pasta:t,resultado:e,processadas:f,total:u})):(b++,i&&i({pasta:t,error:e.error,processadas:f,total:u})),n&&n({processadas:f,total:u,percentual:Math.round(f/u*100),sucessos:v,erros:b,pastaAtual:t.titulo})}s&&s({chunkIndex:e,totalChunks:g.length,processadas:f,total:u}),e<g.length-1&&await h(d)}let k=Date.now()-j;return{resultados:y,estatisticas:{total:u,sucesso:v,erro:b,tempoTotal:k,tempoMedio:Math.round(k/u)}}},f="selection",v="analyzing",b="feedback",j="review",k="uploading",w="complete";e.s(["default",0,({isOpen:e,onClose:i,onSuccess:s,onOpenUploadPasta:n,initialEntries:l})=>{let d,p,c,h,{showToast:g}=(0,r.useUI)(),[m,C]=(0,a.useState)(f),[S,z]=(0,a.useState)([]),[B,A]=(0,a.useState)([]),[P,R]=(0,a.useState)(null),[W,D]=(0,a.useState)({processadas:0,total:0,percentual:0}),[M,F]=(0,a.useState)([]),[$,I]=(0,a.useState)("all"),[E,T]=(0,a.useState)(null),[q,L]=(0,a.useState)({processadas:0,total:0,percentual:0,pastaAtual:""}),[H,N]=(0,a.useState)(null),[O,U]=(0,a.useState)(0),V=["Adicionando os últimos detalhes...","Refinando a visualização das partituras...","Escrevendo o próximo Dobrado Tusca...","Removendo o Dobrado Ludgero da próxima apresentação...","Ratando a primeira nota de Preta Pretinha...","Esperando João Viana voltar do banheiro...","Deixando Julielson menos durinho no pandeiro...","Afinando os pistões virtuais...","Procurando a partitura perdida do saxofone...","Ajustando o compasso que ninguém acerta...","Adicionando mais uma fermata só de sacanagem...","Verificando se o bombardino está acordado...","Calibrando o volume da tuba...","Inserindo pausas estratégicas para o café...","Convencendo o maestro que está tudo certo...","Organizando as estantes de partitura..."],[J,_]=(0,a.useState)(!1),K=(0,a.useRef)(null),G=(0,a.useRef)(null);(0,a.useEffect)(()=>{let t=async()=>{try{let[e,t]=await Promise.all([o.API.getCategorias(),o.API.getPartituras()]);z(e||[]),F(t||[])}catch{}};e&&t()},[e]),(0,a.useEffect)(()=>{e||(null!==G.current&&(clearTimeout(G.current),G.current=null),C(f),A([]),R(null),D({processadas:0,total:0,percentual:0}),I("all"),T(null),L({processadas:0,total:0,percentual:0,pastaAtual:""}),N(null),U(0))},[e]),(0,a.useEffect)(()=>{if(m===k){let e=setInterval(()=>{U(e=>(e+1)%V.length)},2500);return()=>clearInterval(e)}},[m,V.length]),(0,a.useEffect)(()=>{(async()=>{if(e&&l&&0!==l.length&&0!==S.length&&m===f){C(v);try{let{pastas:e,estatisticas:t}=await x(l,S,M,D);if(0===e.length){g("Nenhuma pasta com PDFs encontrada","error"),C(f);return}A(e),R(t),C(b),G.current=setTimeout(()=>{G.current=null,C(j)},2500)}catch(e){console.error("Erro na analise:",e),g("Erro ao analisar pastas","error"),C(f)}}})()},[e,l,S,M]);let Q=async e=>{e.preventDefault(),e.stopPropagation(),_(!1);let t=e.dataTransfer.items;if(t&&0!==t.length){C(v);try{let{pastas:e,estatisticas:a}=await x(t,S,M,D);if(0===e.length){g("Nenhuma pasta com PDFs encontrada","error"),C(f);return}A(e),R(a),C(b),setTimeout(()=>{C(j)},2500)}catch(e){console.error("Erro na analise:",e),g("Erro ao analisar pastas","error"),C(f)}}},Y=async e=>{let t=e.target.files;if(t&&0!==t.length){C(v);try{let{pastas:e,estatisticas:a}=await u(t,S,M,D);if(0===e.length){g("Nenhuma pasta com PDFs encontrada","error"),C(f);return}A(e),R(a),C(b),setTimeout(()=>{C(j)},2500)}catch(e){console.error("Erro na analise:",e),g("Erro ao analisar pastas","error"),C(f)}}},X=(0,a.useCallback)(e=>{A(t=>t.map(t=>t.id===e?{...t,selecionada:!t.selecionada}:t))},[]),Z=(0,a.useCallback)(e=>{A(t=>t.map(t=>({...t,selecionada:e})))},[]),ee=(0,a.useCallback)((e,t)=>{A(a=>a.map(a=>{if(a.id!==e)return a;let r={...a,categoria:t};return t&&"attention"===a.status&&"Categoria nao detectada"===a.statusMotivo&&(r.status="ready",r.statusMotivo=null),r}))},[]),et=(0,a.useCallback)((e,t)=>{A(a=>a.map(a=>a.id===e?{...a,titulo:t}:a))},[]),ea=(0,a.useCallback)((e,t)=>{A(a=>a.map(a=>a.id===e?{...a,compositor:t}:a))},[]),er=(0,a.useCallback)((e,t)=>{A(a=>a.map(a=>a.id===e?{...a,arranjador:t}:a))},[]),eo=async()=>{let e=B.filter(e=>e.selecionada&&"problem"!==e.status);if(0===e.length)return void g("Nenhuma partitura selecionada para upload","error");C(k),L({processadas:0,total:e.length,percentual:0,pastaAtual:""});try{let{resultados:t,estatisticas:a}=await y(e,{onProgress:L,onPastaError:({pasta:e,error:t})=>{console.error(`Erro no upload de ${e.titulo}:`,t)}});N({resultados:t,estatisticas:a}),C(w),a.sucesso>0&&s?.()}catch(e){console.error("Erro no upload:",e),g("Erro durante o upload","error"),C(j)}},ei="all"===$?B:B.filter(e=>e.status===$),es={all:B.length,ready:B.filter(e=>"ready"===e.status).length,attention:B.filter(e=>"attention"===e.status).length,problem:B.filter(e=>"problem"===e.status).length},en=B.filter(e=>e.selecionada&&"problem"!==e.status);return e?(0,t.jsx)("div",{onClick:i,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.9)",backdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:(0,t.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{background:"var(--bg-card)",borderRadius:"16px",width:"100%",maxWidth:m===j?"900px":"600px",maxHeight:"90vh",display:"flex",flexDirection:"column",overflow:"hidden",fontFamily:"var(--font-sans)",transition:"max-width 0.3s ease"},children:[(0,t.jsxs)("div",{style:{padding:"24px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{style:{fontSize:"20px",fontWeight:"700",color:"var(--text-primary)",display:"flex",alignItems:"center",gap:"10px",marginBottom:"4px"},children:[(0,t.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"#D4AF37",strokeWidth:"2",children:[(0,t.jsx)("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),(0,t.jsx)("path",{d:"M12 11v6M9 14h6"})]}),"Importacao em Lote"]}),(0,t.jsxs)("p",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:[m===f&&"Arraste uma pasta contendo varias partituras",m===v&&"Analisando estrutura das pastas...",m===b&&"Analise concluida!",m===j&&`${es.all} partitura${1!==es.all?"s":""} detectada${1!==es.all?"s":""}`,m===k&&"Enviando partituras...",m===w&&"Upload finalizado!"]})]}),(0,t.jsx)("button",{onClick:i,style:{background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer",padding:"8px",borderRadius:"8px",transition:"all 0.2s"},onMouseEnter:e=>e.currentTarget.style.background="var(--bg-primary)",onMouseLeave:e=>e.currentTarget.style.background="none",children:(0,t.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,t.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,t.jsx)("input",{ref:K,id:"batch-folder-input",type:"file",webkitdirectory:"",directory:"",multiple:!0,onChange:Y,style:{display:"none"}}),(0,t.jsxs)("div",{style:{flex:1,overflow:"auto",padding:"24px"},children:[m===f&&(0,t.jsxs)("div",{onClick:()=>{let e=document.getElementById("batch-folder-input");e&&(e.value="",e.click())},onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),_(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget.contains(e.relatedTarget)||_(!1)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:Q,style:{display:"block",border:J?"2px dashed #D4AF37":"2px dashed var(--border)",borderRadius:"12px",padding:"60px 40px",textAlign:"center",background:J?"linear-gradient(145deg, rgba(212, 175, 55, 0.15) 0%, rgba(184, 134, 11, 0.08) 100%)":"var(--bg-primary)",cursor:"pointer",transition:"all 0.3s ease",transform:J?"scale(1.02)":"scale(1)"},children:[(0,t.jsx)("div",{style:{width:"100px",height:"100px",margin:"0 auto 24px",borderRadius:"24px",background:"linear-gradient(145deg, rgba(212, 175, 55, 0.15) 0%, rgba(212, 175, 55, 0.05) 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#D4AF37",strokeWidth:"1.5",children:[(0,t.jsx)("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}),(0,t.jsx)("path",{d:"M12 11v6M9 14h6",opacity:"0.6"})]})}),(0,t.jsx)("div",{style:{fontSize:"18px",fontWeight:"600",color:J?"#D4AF37":"var(--text-primary)",marginBottom:"8px"},children:J?"Solte as pastas aqui!":"Arraste uma pasta ou clique para selecionar"}),(0,t.jsx)("div",{style:{fontSize:"14px",color:"var(--text-secondary)",marginBottom:"24px"},children:"Selecione uma pasta contendo subpastas de partituras"}),(0,t.jsxs)("div",{style:{display:"flex",gap:"16px",justifyContent:"center",fontSize:"12px",color:"var(--text-muted)"},children:[(0,t.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,t.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,t.jsx)("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),"Multiplas pastas"]}),(0,t.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,t.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,t.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"})}),"Arquivos PDF"]}),(0,t.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,t.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("polyline",{points:"12 6 12 12 16 14"})]}),"Deteccao automatica"]})]})]}),m===v&&(0,t.jsxs)("div",{style:{textAlign:"center",padding:"40px"},children:[(0,t.jsx)("div",{style:{width:"140px",height:"140px",margin:"0 auto 24px",borderRadius:"50%",background:"linear-gradient(145deg, rgba(212, 175, 55, 0.12) 0%, rgba(184, 134, 11, 0.06) 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 24px rgba(212, 175, 55, 0.08)"},children:(0,t.jsxs)("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"none",stroke:"#D4AF37",strokeWidth:"1.5",style:{animation:"spin 2s linear infinite"},children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10",strokeOpacity:"0.25"}),(0,t.jsx)("path",{d:"M12 2a10 10 0 0 1 10 10",strokeLinecap:"round"})]})}),(0,t.jsx)("div",{style:{fontSize:"18px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"8px"},children:"Preparando arquivos..."}),(0,t.jsx)("div",{style:{fontSize:"14px",color:"var(--text-secondary)",marginBottom:"24px"},children:W.total>0?`Organizando ${W.total} arquivo(s)...`:"Lendo estrutura de diretorios..."}),W.total>0&&(0,t.jsx)("div",{style:{width:"100%",maxWidth:"300px",height:"6px",background:"rgba(212, 175, 55, 0.1)",borderRadius:"3px",overflow:"hidden",margin:"0 auto"},children:(0,t.jsx)("div",{style:{width:`${W.percentual}%`,height:"100%",background:"linear-gradient(90deg, #D4AF37, #B8860B)",borderRadius:"3px",transition:"width 0.3s ease-out"}})})]}),m===b&&P&&(0,t.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(p="success"===(d=(e=>{let{total:t,prontas:a}=e;if(0===t)return{percentual:0,tipo:"failure"};let r=Math.round(a/t*100);return 100===r?{percentual:r,tipo:"success"}:r>=50?{percentual:r,tipo:"partial"}:{percentual:r,tipo:"failure"}})(P)).tipo?"rgba(39, 174, 96, 0.1)":"partial"===d.tipo?"rgba(230, 126, 34, 0.1)":"rgba(231, 76, 60, 0.1)",(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{width:"160px",height:"160px",margin:"0 auto 24px",borderRadius:"50%",background:p,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 4px 24px ${p}`},children:(0,t.jsx)("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"none",stroke:"#27ae60",strokeWidth:"2",children:(0,t.jsx)("polyline",{points:"20 6 9 17 4 12"})})}),(0,t.jsxs)("div",{style:{fontSize:"24px",fontWeight:"700",color:"success"===d.tipo?"#27ae60":"partial"===d.tipo?"#e67e22":"#e74c3c",marginBottom:"8px"},children:["success"===d.tipo&&"Tudo pronto!","partial"===d.tipo&&"Quase la!","failure"===d.tipo&&"Precisa de atencao"]}),(0,t.jsxs)("div",{style:{fontSize:"16px",color:"var(--text-secondary)"},children:[P.prontas," de ",P.total," partitura",1!==P.total?"s":""," pronta",1!==P.prontas?"s":""," para upload"]})]}))}),m===j&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{display:"flex",gap:"8px",marginBottom:"20px",borderBottom:"1px solid var(--border)",paddingBottom:"12px"},children:[{key:"all",label:"Todas",count:es.all,color:void 0},{key:"ready",label:"Prontas",count:es.ready,color:"#27ae60"},{key:"attention",label:"Atencao",count:es.attention,color:"#e67e22"},{key:"problem",label:"Problemas",count:es.problem,color:"#e74c3c"}].map(e=>(0,t.jsxs)("button",{onClick:()=>I(e.key),style:{padding:"8px 16px",borderRadius:"20px",border:"none",background:$===e.key?e.color?`${e.color}20`:"rgba(212, 175, 55, 0.15)":"transparent",color:$===e.key?e.color||"#D4AF37":"var(--text-secondary)",fontSize:"13px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s"},children:[e.label,(0,t.jsx)("span",{style:{background:e.color?`${e.color}30`:"var(--bg-primary)",padding:"2px 8px",borderRadius:"10px",fontSize:"11px"},children:e.count})]},e.key))}),(0,t.jsxs)("div",{style:{display:"flex",gap:"12px",marginBottom:"16px",fontSize:"13px"},children:[(0,t.jsx)("button",{onClick:()=>Z(!0),style:{background:"none",border:"none",color:"#D4AF37",cursor:"pointer",padding:"4px 8px"},children:"Selecionar todas"}),(0,t.jsx)("button",{onClick:()=>Z(!1),style:{background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer",padding:"4px 8px"},children:"Limpar selecao"})]}),(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px",maxHeight:"400px",overflowY:"auto"},children:ei.map(e=>(0,t.jsxs)("div",{style:{background:"var(--bg-primary)",borderRadius:"12px",border:`1px solid ${"ready"===e.status?"var(--border)":"attention"===e.status?"#e67e22":"#e74c3c"}`},children:[(0,t.jsxs)("div",{onClick:()=>T(E===e.id?null:e.id),style:{padding:"12px 16px",display:"flex",alignItems:"center",gap:"12px",cursor:"pointer"},children:[(0,t.jsx)("input",{type:"checkbox",checked:e.selecionada,onChange:t=>{t.stopPropagation(),X(e.id)},disabled:"problem"===e.status,style:{cursor:"problem"===e.status?"not-allowed":"pointer"}}),(0,t.jsxs)("span",{style:{width:"24px",height:"24px",borderRadius:"50%",background:"ready"===e.status?"rgba(39, 174, 96, 0.15)":"attention"===e.status?"rgba(230, 126, 34, 0.15)":"rgba(231, 76, 60, 0.15)",display:"flex",alignItems:"center",justifyContent:"center"},children:["ready"===e.status&&(0,t.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#27ae60",strokeWidth:"2.5",children:(0,t.jsx)("polyline",{points:"20 6 9 17 4 12"})}),"attention"===e.status&&(0,t.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#e67e22",strokeWidth:"2",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,t.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),"problem"===e.status&&(0,t.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#e74c3c",strokeWidth:"2",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,t.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})]}),(0,t.jsxs)("div",{style:{flex:1,minWidth:"100px",overflow:"hidden"},children:[(0,t.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"var(--text-primary)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"1.4",marginBottom:"6px"},children:e.titulo||e.nomePasta||"Sem titulo"}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",flexWrap:"wrap"},children:[(0,t.jsxs)("span",{style:{fontSize:"11px",padding:"2px 8px",borderRadius:"10px",background:"var(--bg-secondary)",color:"var(--text-secondary)",border:"1px solid var(--border)"},children:[e.arquivos.length," arquivo",1!==e.arquivos.length?"s":""]}),(0,t.jsxs)("span",{onClick:e=>{e.stopPropagation();let t=e.currentTarget.querySelector("select");t&&t.click()},style:{fontSize:"11px",padding:"2px 8px",borderRadius:"10px",background:e.categoria?"rgba(212, 175, 55, 0.1)":"rgba(230, 126, 34, 0.1)",color:e.categoria?"#D4AF37":"#e67e22",border:`1px solid ${e.categoria?"rgba(212, 175, 55, 0.3)":"rgba(230, 126, 34, 0.3)"}`,cursor:"pointer",fontWeight:"500",display:"inline-flex",alignItems:"center",gap:"4px",position:"relative"},children:[S.find(t=>t.id===e.categoria)?.nome||"Categoria",(0,t.jsx)("svg",{width:"8",height:"8",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:(0,t.jsx)("polyline",{points:"6 9 12 15 18 9"})}),(0,t.jsxs)("select",{value:e.categoria||"",onClick:e=>e.stopPropagation(),onChange:t=>{t.stopPropagation(),ee(e.id,t.target.value)},style:{position:"absolute",opacity:0,top:0,left:0,width:"100%",height:"100%",cursor:"pointer"},children:[(0,t.jsx)("option",{value:"",children:"Categoria"}),S.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nome},e.id))]})]}),e.statusMotivo&&(0,t.jsx)("span",{style:{fontSize:"11px",padding:"2px 8px",borderRadius:"10px",background:"attention"===e.status?"rgba(230, 126, 34, 0.1)":"rgba(231, 76, 60, 0.1)",color:"attention"===e.status?"#e67e22":"#e74c3c",border:`1px solid ${"attention"===e.status?"rgba(230, 126, 34, 0.3)":"rgba(231, 76, 60, 0.3)"}`},children:e.statusMotivo})]})]}),"problem"===e.status&&(0,t.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[e.duplicada&&(0,t.jsxs)("button",{onClick:t=>{t.stopPropagation(),A(t=>t.map(t=>t.id===e.id?{...t,status:"attention",statusMotivo:"Duplicada (forcado)",selecionada:!0}:t))},style:{padding:"6px 12px",borderRadius:"6px",border:"1px solid #e67e22",background:"rgba(230, 126, 34, 0.1)",color:"#e67e22",fontSize:"12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap"},children:[(0,t.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("path",{d:"M12 9v4M12 17h.01"}),(0,t.jsx)("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"})]}),"Forcar"]}),!e.duplicada&&(0,t.jsxs)("button",{onClick:t=>{t.stopPropagation(),n&&(n(e),A(t=>t.filter(t=>t.id!==e.id)))},style:{padding:"6px 12px",borderRadius:"6px",border:"1px solid #e74c3c",background:"rgba(231, 76, 60, 0.1)",color:"#e74c3c",fontSize:"12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[(0,t.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,t.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),"Resolver"]})]}),(0,t.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"var(--text-muted)",strokeWidth:"2",style:{transform:E===e.id?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:(0,t.jsx)("polyline",{points:"6 9 12 15 18 9"})})]}),E===e.id&&(0,t.jsxs)("div",{style:{padding:"12px 16px",background:"var(--bg-secondary)",borderTop:"1px solid var(--border)"},children:[(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"12px"},children:[(0,t.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"11px",color:"var(--text-muted)",marginBottom:"3px",fontWeight:"500"},children:"Titulo"}),(0,t.jsx)("input",{type:"text",value:e.titulo||"",onClick:e=>e.stopPropagation(),onChange:t=>et(e.id,t.target.value),placeholder:"Nome da partitura",style:{width:"100%",padding:"8px 10px",borderRadius:"6px",border:"1px solid var(--border)",background:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"13px",fontWeight:"500"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"11px",color:"var(--text-muted)",marginBottom:"3px",fontWeight:"500"},children:"Compositor"}),(0,t.jsx)("input",{type:"text",value:e.compositor||"",onClick:e=>e.stopPropagation(),onChange:t=>ea(e.id,t.target.value),placeholder:"Nome do compositor",style:{width:"100%",padding:"8px 10px",borderRadius:"6px",border:"1px solid var(--border)",background:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"13px"}})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"11px",color:"var(--text-muted)",marginBottom:"3px",fontWeight:"500"},children:"Arranjador"}),(0,t.jsx)("input",{type:"text",value:e.arranjador||"",onClick:e=>e.stopPropagation(),onChange:t=>er(e.id,t.target.value),placeholder:"Nome do arranjador",style:{width:"100%",padding:"8px 10px",borderRadius:"6px",border:"1px solid var(--border)",background:"var(--bg-primary)",color:"var(--text-primary)",fontSize:"13px"}})]})]}),(0,t.jsxs)("div",{style:{fontSize:"12px"},children:[(0,t.jsx)("div",{style:{color:"var(--text-secondary)",marginBottom:"8px"},children:"Arquivos detectados:"}),(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"6px"},children:e.arquivos.map((e,a)=>(0,t.jsxs)("div",{style:{padding:"6px 10px",borderRadius:"4px",background:e.reconhecido?"rgba(39, 174, 96, 0.1)":"rgba(230, 126, 34, 0.1)",color:e.reconhecido?"#27ae60":"#e67e22",display:"flex",alignItems:"center",gap:"6px"},children:[e.reconhecido?(0,t.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:(0,t.jsx)("polyline",{points:"20 6 9 17 4 12"})}):(0,t.jsxs)("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,t.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.instrumento]},a))})]})]})]},e.id))})]}),m===k&&(0,t.jsxs)("div",{style:{textAlign:"center",padding:"40px 40px 32px"},children:[(0,t.jsx)("div",{style:{width:"120px",height:"120px",margin:"0 auto 28px",borderRadius:"50%",background:"linear-gradient(145deg, rgba(212, 175, 55, 0.12) 0%, rgba(184, 134, 11, 0.06) 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 24px rgba(212, 175, 55, 0.08)"},children:(0,t.jsxs)("svg",{width:"50",height:"50",viewBox:"0 0 24 24",fill:"none",stroke:"#D4AF37",strokeWidth:"1.5",style:{animation:"spin 2s linear infinite"},children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10",strokeOpacity:"0.25"}),(0,t.jsx)("path",{d:"M12 2a10 10 0 0 1 10 10",strokeLinecap:"round"})]})}),(0,t.jsx)("div",{style:{fontSize:"20px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"6px"},children:"Enviando partituras"}),(0,t.jsxs)("div",{style:{fontSize:"14px",color:"var(--text-secondary)",marginBottom:"16px"},children:[q.processadas," de ",q.total," concluida",1!==q.processadas?"s":""]}),(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"32px",minHeight:"24px"},children:(0,t.jsx)("span",{style:{fontSize:"13px",color:"#D4AF37",fontStyle:"italic"},children:V[O]},O)}),(0,t.jsxs)("div",{style:{width:"100%",maxWidth:"400px",margin:"0 auto"},children:[(0,t.jsx)("div",{style:{position:"relative",height:"8px",background:"var(--bg-primary)",borderRadius:"4px",overflow:"hidden",marginBottom:"16px"},children:(0,t.jsx)("div",{style:{position:"absolute",left:0,top:0,width:`${q.percentual}%`,height:"100%",background:"linear-gradient(90deg, #D4AF37 0%, #F4D03F 50%, #D4AF37 100%)",backgroundSize:"200% 100%",borderRadius:"4px",transition:"width 0.4s cubic-bezier(0.4, 0, 0.2, 1)",animation:"shimmer 2s linear infinite"}})}),(0,t.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"6px",marginTop:"20px"},children:B.filter(e=>e.selecionada&&"problem"!==e.status).map((e,a)=>{let r=a<q.processadas,o=a===q.processadas;return(0,t.jsx)("div",{title:e.titulo,style:{width:o?"24px":"8px",height:"8px",borderRadius:"4px",background:r?"#27ae60":o?"linear-gradient(90deg, #D4AF37, #F4D03F)":"var(--bg-secondary)",transition:"all 0.3s ease",cursor:"default"}},e.id)})})]}),(0,t.jsx)("style",{children:`
                @keyframes spin {
                  to { transform: rotate(360deg); }
                }
                @keyframes shimmer {
                  0% { background-position: 200% 0; }
                  100% { background-position: -200% 0; }
                }
              `})]}),m===w&&H&&(0,t.jsx)("div",{style:{textAlign:"center",padding:"40px"},children:(h="success"===(c=(e=>{let t,a,r=e.total??e.sucesso+e.erro,{sucesso:o,erro:i}=e,s=e.tempoTotal??0,n=r>0?Math.round(o/r*100):0;return{mensagem:0===i?`${o} partitura${1!==o?"s":""} enviada${1!==o?"s":""} com sucesso!`:`${o} de ${r} partitura${1!==r?"s":""} enviada${1!==o?"s":""} (${i} erro${1!==i?"s":""})`,tipo:0===i?"success":o>0?"partial":"error",percentualSucesso:n,duracao:(a=Math.floor((t=Math.floor(s/1e3))/60))>0?`${a}m ${t%60}s`:`${t}s`}})(H.estatisticas)).tipo?"rgba(39, 174, 96, 0.1)":"partial"===c.tipo?"rgba(230, 126, 34, 0.1)":"rgba(231, 76, 60, 0.1)",(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{width:"160px",height:"160px",margin:"0 auto 24px",borderRadius:"50%",background:h,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 4px 24px ${h}`},children:(0,t.jsx)("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"none",stroke:"#27ae60",strokeWidth:"2",children:(0,t.jsx)("polyline",{points:"20 6 9 17 4 12"})})}),(0,t.jsxs)("div",{style:{fontSize:"20px",fontWeight:"700",color:"success"===c.tipo?"#27ae60":"partial"===c.tipo?"#e67e22":"#e74c3c",marginBottom:"8px"},children:["success"===c.tipo&&"Upload concluido!","partial"===c.tipo&&"Upload parcial","error"===c.tipo&&"Falha no upload"]}),(0,t.jsx)("div",{style:{fontSize:"16px",color:"var(--text-secondary)",marginBottom:"8px"},children:c.mensagem}),(0,t.jsxs)("div",{style:{fontSize:"13px",color:"var(--text-muted)"},children:["Tempo total: ",c.duracao]}),H.estatisticas.erro>0&&(0,t.jsxs)("div",{style:{marginTop:"24px",padding:"16px",background:"rgba(231, 76, 60, 0.1)",borderRadius:"12px",textAlign:"left",maxWidth:"350px",margin:"24px auto 0"},children:[(0,t.jsx)("div",{style:{fontSize:"13px",fontWeight:"600",color:"#e74c3c",marginBottom:"8px"},children:"Erros encontrados:"}),H.resultados.filter(e=>!e.success).map((e,a)=>(0,t.jsxs)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:["• ",e.titulo,": ",e.error]},a))]})]}))})]}),(m===j||m===w)&&(0,t.jsxs)("div",{style:{padding:"16px 24px",borderTop:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"12px"},children:[m===j&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{fontSize:"13px",color:"var(--text-secondary)"},children:[en.length," de ",B.filter(e=>"problem"!==e.status).length," selecionada",1!==en.length?"s":"",en.length>0&&(0,t.jsxs)("span",{style:{marginLeft:"8px"},children:["(",((e,t)=>{let a,r=2e3*e+500*(t||0),o=Math.ceil(r/1e3);if(o<60)a=`~${o} segundos`;else{let e=Math.ceil(o/60);a=`~${e} minuto${e>1?"s":""}`}return{tempoEstimado:r,tempoFormatado:a}})(en.length,en.reduce((e,t)=>e+t.arquivos.length,0)).tempoFormatado,")"]})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,t.jsx)("button",{onClick:i,style:{padding:"12px 24px",borderRadius:"12px",background:"var(--bg-primary)",border:"1px solid var(--border)",color:"var(--text-primary)",fontSize:"14px",cursor:"pointer"},children:"Cancelar"}),(0,t.jsxs)("button",{onClick:eo,disabled:0===en.length,style:{padding:"12px 24px",borderRadius:"12px",background:0===en.length?"linear-gradient(135deg, rgba(212, 175, 55, 0.5) 0%, rgba(184, 134, 11, 0.5) 100%)":"linear-gradient(135deg, #D4AF37 0%, #B8860B 100%)",border:"none",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:0===en.length?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,t.jsx)("polyline",{points:"17 8 12 3 7 8"}),(0,t.jsx)("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),"Enviar ",en.length," partitura",1!==en.length?"s":""]})]})]}),m===w&&(0,t.jsx)("div",{style:{width:"100%",textAlign:"center"},children:(0,t.jsx)("button",{onClick:i,style:{padding:"12px 32px",borderRadius:"12px",background:"linear-gradient(135deg, #D4AF37 0%, #B8860B 100%)",border:"none",color:"#fff",fontSize:"14px",fontWeight:"600",cursor:"pointer"},children:"Fechar"})})]})]})}):null}],22589)}]);